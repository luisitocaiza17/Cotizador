diff --git a/WebContent/WEB-INF/web.xml b/WebContent/WEB-INF/web.xml
deleted file mode 100644
--- a/WebContent/WEB-INF/web.xml
+++ /dev/null
@@ -1,426 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">
-  <display-name>CotizadorWeb</display-name>
-  <welcome-file-list>
-    <welcome-file>index.html</welcome-file>
-    <welcome-file>index.htm</welcome-file>
-    <welcome-file>index.jsp</welcome-file>
-    <welcome-file>default.html</welcome-file>
-    <welcome-file>default.htm</welcome-file>
-    <welcome-file>default.jsp</welcome-file>
-  </welcome-file-list>
-  <listener>
-    <listener-class>com.sun.xml.ws.transport.http.servlet.WSServletContextListener</listener-class>
-  </listener>
-  <servlet>
-    <servlet-name>CotizadorWS</servlet-name>
-    <servlet-class>com.sun.xml.ws.transport.http.servlet.WSServlet</servlet-class>
-    <load-on-startup>1</load-on-startup>
-  </servlet>
-  <listener>
-    <listener-class>org.apache.commons.fileupload.servlet.FileCleanerCleanup</listener-class>
-  </listener>
-  <servlet>
-    <display-name>Apache-Axis Servlet</display-name>
-    <servlet-name>AxisServlet</servlet-name>
-    <servlet-class>org.apache.axis.transport.http.AxisServlet</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>AxisServlet</servlet-name>
-    <url-pattern>/servlet/AxisServlet</url-pattern>
-  </servlet-mapping>
-  <servlet-mapping>
-    <servlet-name>AxisServlet</servlet-name>
-    <url-pattern>*.jws</url-pattern>
-  </servlet-mapping>
-  <servlet-mapping>
-    <servlet-name>AxisServlet</servlet-name>
-    <url-pattern>/services/*</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <display-name>Axis Admin Servlet</display-name>
-    <servlet-name>AdminServlet</servlet-name>
-    <servlet-class>org.apache.axis.transport.http.AdminServlet</servlet-class>
-    <load-on-startup>100</load-on-startup>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>AdminServlet</servlet-name>
-    <url-pattern>/servlet/AdminServlet</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.seguridad.AccesoSistemaController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.seguridad.AccesoSistemaController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.seguridad.AccesoSistemaController</servlet-name>
-    <url-pattern>/AccesoSistemaController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.SucursalController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.entidad.SucursalController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.SucursalController</servlet-name>
-    <url-pattern>/SucursalController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.PuntoVentaController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.entidad.PuntoVentaController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.PuntoVentaController</servlet-name>
-    <url-pattern>/PuntoVentaController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.EntidadController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.entidad.EntidadController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.EntidadController</servlet-name>
-    <url-pattern>/EntidadController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculo.MarcaController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.producto.vehiculo.MarcaController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculo.MarcaController</servlet-name>
-    <url-pattern>/MarcaController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculo.ModeloController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.producto.vehiculo.ModeloController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculo.ModeloController</servlet-name>
-    <url-pattern>/ModeloController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculo.TipoExtraController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.producto.vehiculo.TipoExtraController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculo.TipoExtraController</servlet-name>
-    <url-pattern>/TipoExtraController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.TipoIdentificacionController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.entidad.TipoIdentificacionController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.TipoIdentificacionController</servlet-name>
-    <url-pattern>/TipoIdentificacionController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.seguridad.VariableSistemaController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.seguridad.VariableSistemaController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.seguridad.VariableSistemaController</servlet-name>
-    <url-pattern>/VariableSistemaController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.ProductoGrupoController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.cotizacion.ProductoGrupoController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.ProductoGrupoController</servlet-name>
-    <url-pattern>/ProductoGrupoController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.UnidadNegocioController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.entidad.UnidadNegocioController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.UnidadNegocioController</servlet-name>
-    <url-pattern>/UnidadNegocioController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.UnidadProduccionController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.entidad.UnidadProduccionController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.UnidadProduccionController</servlet-name>
-    <url-pattern>/UnidadProduccionController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.UsuarioXPuntoVentaController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.entidad.UsuarioXPuntoVentaController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.UsuarioXPuntoVentaController</servlet-name>
-    <url-pattern>/UsuarioXPuntoVentaController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.MotivoDescuentoController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.cotizacion.MotivoDescuentoController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.MotivoDescuentoController</servlet-name>
-    <url-pattern>/MotivoDescuentoController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculo.ObjetoVehiculoController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.producto.vehiculo.ObjetoVehiculoController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculo.ObjetoVehiculoController</servlet-name>
-    <url-pattern>/ObjetoVehiculoController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.reportes.ReportesController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.reportes.ReportesController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.reportes.ReportesController</servlet-name>
-    <url-pattern>/ReportesController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.EmpleadoController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.entidad.EmpleadoController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.EmpleadoController</servlet-name>
-    <url-pattern>/EmpleadoController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.seguridad.ConfirmarMailController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.seguridad.ConfirmarMailController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.seguridad.ConfirmarMailController</servlet-name>
-    <url-pattern>/ConfirmarMail</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.ConfirmarSolicitudDescuentoController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.cotizacion.ConfirmarSolicitudDescuentoController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.ConfirmarSolicitudDescuentoController</servlet-name>
-    <url-pattern>/ConfirmarSolicitudDescuento</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.seguridad.SalirSistemaController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.seguridad.SalirSistemaController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.seguridad.SalirSistemaController</servlet-name>
-    <url-pattern>/SalirSistema</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculo.ColorController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.producto.vehiculo.ColorController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculo.ColorController</servlet-name>
-    <url-pattern>/ColorController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.CotizacionController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.cotizacion.CotizacionController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.CotizacionController</servlet-name>
-    <url-pattern>/CotizacionController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculo.EmisionVHController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.producto.vehiculo.EmisionVHController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculo.EmisionVHController</servlet-name>
-    <url-pattern>/EmisionVHController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.UPLAController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.entidad.UPLAController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.UPLAController</servlet-name>
-    <url-pattern>/UPLAController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.inspeccion.ComentarioSolicitudInspeccionController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.inspeccion.ComentarioSolicitudInspeccionController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.inspeccion.ComentarioSolicitudInspeccionController</servlet-name>
-    <url-pattern>/ComentarioSolicitudInspeccionController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.archivos.CargaArchivosController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.archivos.CargaArchivosController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.archivos.CargaArchivosController</servlet-name>
-    <url-pattern>/CargaArchivosController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.archivos.DocumentoVisadoController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.archivos.DocumentoVisadoController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.archivos.DocumentoVisadoController</servlet-name>
-    <url-pattern>/DocumentoVisadoController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculocerrado.DetalleProductoController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.producto.vehiculocerrado.DetalleProductoController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculocerrado.DetalleProductoController</servlet-name>
-    <url-pattern>/DetalleProductoController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculocerrado.GrupoPorProductoController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.producto.vehiculocerrado.GrupoPorProductoController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculocerrado.GrupoPorProductoController</servlet-name>
-    <url-pattern>/GrupoPorProductoController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculocerrado.GrupoProductoController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.producto.vehiculocerrado.GrupoProductoController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculocerrado.GrupoProductoController</servlet-name>
-    <url-pattern>/GrupoProductoController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculocerrado.TasaProductoController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.producto.vehiculocerrado.TasaProductoController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculocerrado.TasaProductoController</servlet-name>
-    <url-pattern>/TasaProductoController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.CotizacionVHCerradosController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.cotizacion.CotizacionVHCerradosController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.CotizacionVHCerradosController</servlet-name>
-    <url-pattern>/CotizacionVHCerradosController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.mantenimiento.MantenimientoController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.mantenimiento.MantenimientoController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.mantenimiento.MantenimientoController</servlet-name>
-    <url-pattern>/MantenimientoController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.seguridad.FiltroPathController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.seguridad.FiltroPathController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.seguridad.FiltroPathController</servlet-name>
-    <url-pattern>/static/reportes/*</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.TipoTasaController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.cotizacion.TipoTasaController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.TipoTasaController</servlet-name>
-    <url-pattern>/TipoTasaController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.TipoCoberturaController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.cotizacion.TipoCoberturaController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.TipoCoberturaController</servlet-name>
-    <url-pattern>/TipoCoberturaController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculocerrado.ProductoCoberturaController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.producto.vehiculocerrado.ProductoCoberturaController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculocerrado.ProductoCoberturaController</servlet-name>
-    <url-pattern>/ProductoCoberturaController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculocerrado.PaqueteCoberturaController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.producto.vehiculocerrado.PaqueteCoberturaController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.producto.vehiculocerrado.PaqueteCoberturaController</servlet-name>
-    <url-pattern>/PaqueteCoberturaController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.BeneficiarioController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.entidad.BeneficiarioController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.BeneficiarioController</servlet-name>
-    <url-pattern>/BeneficiarioController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.EndosoBeneficiarioController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.cotizacion.EndosoBeneficiarioController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.EndosoBeneficiarioController</servlet-name>
-    <url-pattern>/EndosoBeneficiarioController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.DireccionController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.entidad.DireccionController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.DireccionController</servlet-name>
-    <url-pattern>/DireccionController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.EntidadJrController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.entidad.EntidadJrController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.entidad.EntidadJrController</servlet-name>
-    <url-pattern>/EntidadJrController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.seguridad.OpcionPantallaController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.seguridad.OpcionPantallaController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.seguridad.OpcionPantallaController</servlet-name>
-    <url-pattern>/OpcionPantallaController</url-pattern>
-  </servlet-mapping>
-  <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.ContenedorController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.cotizacion.ContenedorController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.ContenedorController</servlet-name>
-    <url-pattern>/ContenedorController</url-pattern>
-  </servlet-mapping>  
-   <servlet>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.vehiculos_dinamicos.tarificador.TarificadorController</servlet-name>
-    <servlet-class>com.qbe.cotizador.servlets.cotizacion.vehiculos_dinamicos.tarificador.TarificadorController</servlet-class>
-  </servlet>
-  <servlet-mapping>
-    <servlet-name>com.qbe.cotizador.servlets.cotizacion.vehiculos_dinamicos.tarificador.TarificadorController</servlet-name>
-    <url-pattern>/TarificadorController</url-pattern>
-  </servlet-mapping>
-  <filter>
-    <filter-name>sitemesh</filter-name>
-    <filter-class>com.opensymphony.sitemesh.webapp.SiteMeshFilter</filter-class>
-  </filter>
-  <filter-mapping>
-    <filter-name>sitemesh</filter-name>
-    <url-pattern>/*</url-pattern>
-  </filter-mapping>
-  <session-config>
-    <session-timeout>120</session-timeout>
-  </session-config>
-  <persistence-context-ref>
-    <description>Configuracion Persistence context</description>
-    <persistence-context-ref-name>CotizadorWebPC</persistence-context-ref-name>
-    <persistence-unit-name>CotizadorWebPU</persistence-unit-name>
-  </persistence-context-ref>
-</web-app>
diff --git a/build/classes/com/qbe/cotizador/model/Cliente.class b/build/classes/com/qbe/cotizador/model/Cliente.class
deleted file mode 100644
index a726db7131b3793cd13a36e1be2832277eb944a6..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
GIT binary patch
literal 0
Hc$@<O00001

diff --git a/build/classes/com/qbe/cotizador/model/Entidad.class b/build/classes/com/qbe/cotizador/model/Entidad.class
deleted file mode 100644
index 42d023e5650a3e5e678e09c442cf903213126643..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
GIT binary patch
literal 0
Hc$@<O00001

diff --git a/build/classes/com/qbe/cotizador/model/Modelo.class b/build/classes/com/qbe/cotizador/model/Modelo.class
deleted file mode 100644
index 3596722a05c78460ae95ba0b219ac16905714cea..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
GIT binary patch
literal 0
Hc$@<O00001

diff --git a/build/classes/com/qbe/cotizador/model/ObjetoVehiculo.class b/build/classes/com/qbe/cotizador/model/ObjetoVehiculo.class
deleted file mode 100644
index a6a7e2ba0a7e8cc8d801e892ed83a5a4ea105c20..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
GIT binary patch
literal 0
Hc$@<O00001

diff --git a/build/classes/com/qbe/cotizador/servlets/producto/ganadero/ObjetoGanaderoController.class b/build/classes/com/qbe/cotizador/servlets/producto/ganadero/ObjetoGanaderoController.class
deleted file mode 100644
index 9a6d40ab473a9be24ab025e84dabc5283dc49fe1..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
GIT binary patch
literal 0
Hc$@<O00001

diff --git a/build/classes/com/qbe/cotizador/servlets/producto/pymes/ObjetoPymesController.class b/build/classes/com/qbe/cotizador/servlets/producto/pymes/ObjetoPymesController.class
deleted file mode 100644
index cccbd34c31309b142ccfd5c109670d7c19576e9f..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
GIT binary patch
literal 0
Hc$@<O00001

diff --git a/build/classes/com/qbe/cotizador/util/MotorTarifador.class b/build/classes/com/qbe/cotizador/util/MotorTarifador.class
deleted file mode 100644
index 1de5384e9e5ae6c902912f940c53d2068c63345e..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391
GIT binary patch
literal 0
Hc$@<O00001

diff --git a/src/com/qbe/cotizador/servicios/QBE/agricolaSucre/SolicitudAgricola.java b/src/com/qbe/cotizador/servicios/QBE/agricolaSucre/SolicitudAgricola.java
--- a/src/com/qbe/cotizador/servicios/QBE/agricolaSucre/SolicitudAgricola.java
+++ b/src/com/qbe/cotizador/servicios/QBE/agricolaSucre/SolicitudAgricola.java
@@ -1176,10 +1176,14 @@
 					e.printStackTrace();
 				}
 				
-				/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
-				AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-				agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion,"Registro Solicitud");
-				/**FIN DE REGISTRO DE ENDOSO**/
+				try{
+					/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
+					AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+					agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion,"Registro Solicitud");
+					/**FIN DE REGISTRO DE ENDOSO**/
+				}catch(Exception e){
+					e.printStackTrace();
+				}
 				
 			} else {
 				String IdCotizacion = ExisteCotizacion.getId();
@@ -1619,10 +1623,14 @@
 						ExisteCotizacion.setEstado(estado);
 						CotizacionTransaction cotizacionTransaction = new CotizacionTransaction();
 						cotizacionTransaction.editar(ExisteCotizacion);
-						/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
-						AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-						agriCotizacionDetalleProcesos.creardetalleCotizacion(ExisteCotizacion, Proceso);
-						/**FIN DE REGISTRO DE ENDOSO**/
+						try{
+							/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
+							AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+							agriCotizacionDetalleProcesos.creardetalleCotizacion(ExisteCotizacion, Proceso);
+							/**FIN DE REGISTRO DE ENDOSO**/
+						}catch(Exception e){
+							e.printStackTrace();
+						}
 						respuesta.setEstado("OK");
 						respuesta.setObservacion(ObservacionSucre);
 						
@@ -1777,13 +1785,14 @@
 			String fechaCambio= formatoDelTexto.format(date2);
 			respuesta.setFechaCambio(""+fechaCambio);
 			
-			/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
-			AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-			agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion,"Cambio de fecha");
-			
-			
-			/**FIN DE REGISTRO DE ENDOSO**/
-			
+			try{
+				/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
+				AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+				agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion,"Cambio de fecha");
+				/**FIN DE REGISTRO DE ENDOSO**/
+			}catch(Exception e){
+				e.printStackTrace();
+			}
 			
 			
 			auditoria.setObjeto(fechaAnterior);
@@ -1975,10 +1984,4 @@
 			auditoria.setObjeto(temporal);
 			auditoria.setEstado("ok");
 			
-			/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
-			AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-			agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion, "cambio de lugar");
-			/**FIN DE REGISTRO DE ENDOSO**/
-			
-			
 			try{
@@ -1984,6 +1987,9 @@
 			try{
-				auditoria=procesoAuditoria.editar(auditoria);
+				/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
+				AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+				agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion, "cambio de lugar");
+				/**FIN DE REGISTRO DE ENDOSO**/
 			}catch(Exception e){
 				e.printStackTrace();
 			}
 			
@@ -1986,7 +1992,8 @@
 			}catch(Exception e){
 				e.printStackTrace();
 			}
 			
+			
 			try{
 				procesoAuditoria.editar(auditoria);
 			}catch(Exception e){
@@ -2098,11 +2105,14 @@
 			CotizacionTransaction cotizacionTransaction= new CotizacionTransaction();
 			cotizacionTransaction.editar(cotizacion);
 			
-			/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
-			AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-			agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion, "Revocado");
-			/**FIN DE REGISTRO DE ENDOSO**/
-			
+			try{
+				/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
+				AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+				agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion, "Revocado");
+				/**FIN DE REGISTRO DE ENDOSO**/
+			}catch(Exception e){
+				e.printStackTrace();
+			}
 			
 			respuesta.setEstado("OK");
 			respuesta.setObservacion("PROCESO CORRECTO");
@@ -2112,11 +2122,6 @@
 			
 			auditoria.setObjeto(estadoAnterior);
 			auditoria.setEstado("OK");
-			try{
-				auditoria=procesoAuditoria.editar(auditoria);
-			}catch(Exception e){
-				e.printStackTrace();
-			}
 			
 			try{
 				procesoAuditoria.editar(auditoria);
diff --git a/src/com/qbe/cotizador/servicios/QBE/bancaComunal/EndpointQBEAgricola.java b/src/com/qbe/cotizador/servicios/QBE/bancaComunal/EndpointQBEAgricola.java
--- a/src/com/qbe/cotizador/servicios/QBE/bancaComunal/EndpointQBEAgricola.java
+++ b/src/com/qbe/cotizador/servicios/QBE/bancaComunal/EndpointQBEAgricola.java
@@ -783,10 +783,14 @@
 					agriAuditoriaCotizacionTransaction.crear(agriAuditoriaCotizacion);
 				}
 				
-				/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
-				AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-				agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion, "Registro Solicitud");
-				/**FIN DE REGISTRO DE ENDOSO**/
+				try{
+					/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
+					AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+					agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion, "Registro Solicitud");
+					/**FIN DE REGISTRO DE ENDOSO**/
+				}catch(Exception e){
+					e.printStackTrace();
+				}
 				
 				try{
 					auditoria.setObjeto(variableControl);
@@ -1069,11 +1073,14 @@
 					variableControl=variableControl+" || ValorMonetario "+valorMonetario+" || fechaDesembolso "+fechaDesembolso+" || setNumeroOperacion "+in0.getNumeroOperacion();
 					AgriProcesos.editar(agriObjetoCotizacion);
 					
-					/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
-					AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-					agriCotizacionDetalleProcesos.creardetalleCotizacion(existeCotizacion, "confirmacion Emision");
-					/**FIN DE REGISTRO DE ENDOSO**/
-					
+					try{
+						/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
+						AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+						agriCotizacionDetalleProcesos.creardetalleCotizacion(existeCotizacion, "confirmacion Emision");
+						/**FIN DE REGISTRO DE ENDOSO**/
+					}catch(Exception e){
+						e.printStackTrace();
+					}
 					
 					mensaje="0";
 					try{
diff --git a/src/com/qbe/cotizador/servlets/producto/agricola/AgriAgriPacController.java b/src/com/qbe/cotizador/servlets/producto/agricola/AgriAgriPacController.java
--- a/src/com/qbe/cotizador/servlets/producto/agricola/AgriAgriPacController.java
+++ b/src/com/qbe/cotizador/servlets/producto/agricola/AgriAgriPacController.java
@@ -794,10 +794,14 @@
 						agriAuditoriaCotizacionTransaction.crear(agriAuditoriaCotizacion);
 					}
 					
-					/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
-					AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-					agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion, "Registro Solicitud");
-					/**FIN DE REGISTRO DE ENDOSO**/
+					try{
+						/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
+						AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+						agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion, "Registro Solicitud");
+						/**FIN DE REGISTRO DE ENDOSO**/
+					}catch(Exception e){
+						e.printStackTrace();
+					}
 					
 					auditoria.setEstado(EstadoAuditoria);
 					procesoAuditoria.editar(auditoria);
diff --git a/src/com/qbe/cotizador/servlets/producto/agricola/AgriCotizacionAprobacionController.java b/src/com/qbe/cotizador/servlets/producto/agricola/AgriCotizacionAprobacionController.java
--- a/src/com/qbe/cotizador/servlets/producto/agricola/AgriCotizacionAprobacionController.java
+++ b/src/com/qbe/cotizador/servlets/producto/agricola/AgriCotizacionAprobacionController.java
@@ -49,6 +49,9 @@
 
 
 
+
+
+
 import com.google.gson.Gson;
 import com.google.gson.GsonBuilder;
 
@@ -67,6 +70,9 @@
 
 
 
+
+
+
 //import com.google.common.io.Files;
 import com.qbe.cotizador.dao.producto.agricola.CotizacionAprobacionDAO;
 import com.qbe.cotizador.dao.cotizacion.CotizacionDAO;
@@ -454,10 +460,13 @@
 										// /TODO: Auditoria de aprobaciones y rechazos
 										RegistrarAuditoriaCotizacion(new BigInteger(cotizacionC.getId()),new BigInteger(usuario.getId()),"APROBADO REVISION");
 										
-										//registro el detalle de la cotizacion
-										AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-										agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");
-										
+										try{
+											//registro el detalle de la cotizacion
+											AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+											agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");
+										}catch(Exception e){
+											e.printStackTrace();
+										}
 										mensajeEstado = "La Cotización ha sido aprobada correctamente";
 										
 										result.put("mensajeEstado",mensajeEstado);
@@ -819,14 +828,7 @@
 					listDetalle = procesarEmision(cotizacionList,usuario);
 					//det = procesarEmision(cotizacionList,usuario);
 				}
-				
-//				DataSourceResult pg = new DataSourceResult();
-//				pg.setTotal((int)total);
-//				pg.setData(data);
-//				
-//				Gson gson = new Gson();
-					
-				
+								
 				if (listDetalle.size() > 0) {
 					String IdFile = IdFileIds;
 					IdFileIds="";
@@ -1080,94 +1082,9 @@
 		}
 	}
 
-	/*public List<AgriCotizacionAprobacion> consultarPorTipoObjetoPuntoVentaYEstado(String fecha1,
-			String fecha2, TipoObjeto tipoObjeto, String puntoVenta,
-			String numeroCotizacion,String AgenteId,String NroTramite,String Identificacion,
-			String ApellidosCliente,String CanalId, String estadoCotizacion, int Skip, int Take) {
-		CotizacionAprobacionDAO cDAO = new CotizacionAprobacionDAO();
-		List<AgriCotizacionAprobacion> cotizacion = cDAO.buscarPorNoAprobadasNoEmitidasxFecha(fecha1, tipoObjeto, fecha2, numeroCotizacion, puntoVenta, AgenteId, NroTramite, Identificacion, ApellidosCliente,CanalId, estadoCotizacion, Skip, Take);
-		return cotizacion;
-		
-		JSONObject cotizacionJSONObject = new JSONObject();
-		JSONArray cotizacionJSONArray = new JSONArray();
-		int i;
-		for (i = 0; i < cotizacion.size(); i++) {
-
-			if (cotizacion.get(i).getId() != null) {
-				SimpleDateFormat sm = new SimpleDateFormat("dd/MM/yyyy");
-				cotizacionJSONObject.put("codigo", cotizacion.get(i).getId());
-				cotizacionJSONObject.put("objeto_cotizacion_id", cotizacion
-						.get(i).getObjetoCotizacionId());
-				cotizacionJSONObject.put("puntoVenta_id", cotizacion.get(i)
-						.getPuntoVentaId());
-				cotizacionJSONObject.put("punto_venta", cotizacion.get(i)
-						.getCanalNombre());
-				cotizacionJSONObject.put("tipo_cultivo_id", cotizacion.get(i)
-						.getTipoCultivoId());
-				cotizacionJSONObject.put("tipo_cultivo_nombre",(cotizacion.get(i).getTipoCultivoNombre()==null?"":cotizacion.get(i).getTipoCultivoNombre()));
-				cotizacionJSONObject.put("variedad", (cotizacion.get(i)
-						.getVariedad() == null ? "" : cotizacion.get(i)
-						.getVariedad()));
-				cotizacionJSONObject.put("provincia_nombre", cotizacion.get(i)
-						.getProvinciaNombre());
-				cotizacionJSONObject.put("canton_nombre", cotizacion.get(i)
-						.getCantonNombre());
-				cotizacionJSONObject.put("hectareas_lote", cotizacion.get(i)
-						.getHectareasLote());
-				cotizacionJSONObject.put("hectareas_asegurables", cotizacion
-						.get(i).getHectareasAsegurables());
-				cotizacionJSONObject.put("fecha_siembra", sm.format(cotizacion.get(i).getFechaSiembra()));
-				cotizacionJSONObject.put("suma_asegurada_total", cotizacion
-						.get(i).getSumaAseguradaTotal());
-				cotizacionJSONObject.put("prima_neta_total", cotizacion.get(i)
-						.getPrimaNetaTotal());
-				cotizacionJSONObject.put("monto_credito", cotizacion.get(i)
-						.getMontoCredito());
-				cotizacionJSONObject.put("costo_produccion", cotizacion.get(i)
-						.getCostoProduccion());
-				cotizacionJSONObject.put("seguro_bancos", cotizacion.get(i)
-						.getSeguroBancos());
-				cotizacionJSONObject.put("seguro_campesino", cotizacion.get(i)
-						.getSeguroCampesino());
-				cotizacionJSONObject.put("derecho_emision", cotizacion.get(i)
-						.getDerechoEmision());
-				cotizacionJSONObject.put("iva", cotizacion.get(i).getIva());
-				cotizacionJSONObject.put("totalFactura", cotizacion.get(i).getTotalFactura());
-				///TODO:Cambios nuevos campos 
-				cotizacionJSONObject.put("identificacion_cliente", cotizacion.get(i).getIdentificacionCliente());
-				cotizacionJSONObject.put("nombres_cliente", cotizacion.get(i).getnombresCliente() + " " + 
-				(cotizacion.get(i).getApellidosCliente()==null?"":cotizacion.get(i).getApellidosCliente()));
-				cotizacionJSONObject.put("parroquia_nombre", (cotizacion.get(i).getParroquiaNombre()== null ? "":cotizacion.get(i).getParroquiaNombre()));
-				cotizacionJSONObject.put("sitio", cotizacion.get(i).getDireccionSiembra());
-				cotizacionJSONObject.put("numero_tramite", (cotizacion.get(i).getNumeroTramite()== null ?"": cotizacion.get(i).getNumeroTramite()));
-				cotizacionJSONObject.put("identificacionAgente", (cotizacion.get(i).getIdentificacionAgente()== null ?"": cotizacion.get(i).getIdentificacionAgente()));
-				cotizacionJSONObject.put("nombresAgente", (cotizacion.get(i).getNombresAgente()== null ?"": cotizacion.get(i).getNombresAgente())+
-						(cotizacion.get(i).getApellidosAgente()== null ?"": cotizacion.get(i).getApellidosAgente()));
-				cotizacionJSONObject.put("identificacionUsuario", (cotizacion.get(i).getIdentificacionUsuario()== null ?"": cotizacion.get(i).getIdentificacionUsuario()));
-				cotizacionJSONObject.put("nombresUsuario", (cotizacion.get(i).getNombresUsuario()== null ?"": cotizacion.get(i).getNombresUsuario())+
-						(cotizacion.get(i).getApellidosUsuario()== null ?"": cotizacion.get(i).getApellidosUsuario()));
-				
-				if (cotizacion.get(i).getReglaId()== null || cotizacion.get(i).getReglaId().equals("")){
-					cotizacionJSONObject.put("ObservacionRegla", "* No se ha encontrado una regla para la cotización.");
-					cotizacionJSONObject.put("color", "red");
-				}
-				else {
-					cotizacionJSONObject.put("ObservacionRegla", cotizacion.get(i).getObservacionRegla());
-					cotizacionJSONObject.put("color", "black");
-				}
-			}
-
-			cotizacionJSONArray.add(cotizacionJSONObject);
-
-		}
-
-		// retorno.put("numRegistros",i);
-		// retorno.put("listadoCotizacion", cotizacionJSONArray);
-		return cotizacionJSONArray;
-	}*/
-	
+	/*****PROCESO DE APROBACIONES MASIVAS****/
 	public JSONArray procesarAprobacionMasiva(List<Cotizacion> listado,	Usuario usuario) {
 		JSONObject detalleProceso = new JSONObject();
 		JSONArray detalleProcesoList = new JSONArray();
 		String mensaje = "";
 		try {
@@ -1169,9 +1086,9 @@
 	public JSONArray procesarAprobacionMasiva(List<Cotizacion> listado,	Usuario usuario) {
 		JSONObject detalleProceso = new JSONObject();
 		JSONArray detalleProcesoList = new JSONArray();
 		String mensaje = "";
 		try {
-			for (Cotizacion nuevaCotizacion : listado) {
+			for (Cotizacion nuevaCotizacion : listado) {//listado de cotizaciones a cambiar de estados
 				CotizacionTransaction cotizacionTransaction = new CotizacionTransaction();
 				Cotizacion cotizacionC = new Cotizacion();
 				CotizacionDAO cotizacionCDAO = new CotizacionDAO();
@@ -1175,6 +1092,5 @@
 				CotizacionTransaction cotizacionTransaction = new CotizacionTransaction();
 				Cotizacion cotizacionC = new Cotizacion();
 				CotizacionDAO cotizacionCDAO = new CotizacionDAO();
-				mensaje = "";
 				EstadoDAO estadoDAO = new EstadoDAO();
 				Date VigenciaDesde = new Date();
@@ -1179,3 +1095,5 @@
 				EstadoDAO estadoDAO = new EstadoDAO();
 				Date VigenciaDesde = new Date();
+				
+				mensaje = "";
 				java.sql.Timestamp FechaEmision = new java.sql.Timestamp(VigenciaDesde.getTime());
@@ -1181,5 +1099,6 @@
 				java.sql.Timestamp FechaEmision = new java.sql.Timestamp(VigenciaDesde.getTime());
+				
 				//TODO: Cargar el log de respuesta de sucre para probacion o rechazo
 				AgriSucreAuditoria auditoria = new AgriSucreAuditoria();
 				AgriSucreAuditoriaTransaction procesoAuditoria = new AgriSucreAuditoriaTransaction();
 				String DatosRecibidos = "SERVICIO WEB-AGRICOLA Respuesta SUCRE: ";
@@ -1182,6 +1101,5 @@
 				//TODO: Cargar el log de respuesta de sucre para probacion o rechazo
 				AgriSucreAuditoria auditoria = new AgriSucreAuditoria();
 				AgriSucreAuditoriaTransaction procesoAuditoria = new AgriSucreAuditoriaTransaction();
 				String DatosRecibidos = "SERVICIO WEB-AGRICOLA Respuesta SUCRE: ";
-				
 				try {
@@ -1187,3 +1105,4 @@
 				try {
-					if (nuevaCotizacion.getId() != null && !nuevaCotizacion.getId().equals(""))
+					if (nuevaCotizacion.getId() != null && !nuevaCotizacion.getId().equals(""))//Si la cotizacion existe cambia el estado 
+						//buscamos la cotizacion en base para luego hacer el proceso
 						cotizacionC = cotizacionCDAO.buscarPorId(nuevaCotizacion.getId());
@@ -1189,5 +1108,5 @@
 						cotizacionC = cotizacionCDAO.buscarPorId(nuevaCotizacion.getId());
-					
+						/**PROCESO DE CREACION DE LA AUDITORIA***/
 						//Auditoria Inicia el proceso de cotizacion:
 						//para saber a que hora se hizo la notificacion
 						Date fechaActual= new Date();
@@ -1191,25 +1110,29 @@
 						//Auditoria Inicia el proceso de cotizacion:
 						//para saber a que hora se hizo la notificacion
 						Date fechaActual= new Date();
-						AgriSucreAuditoria agriSucreAuditoria2 = new AgriSucreAuditoria();
-						AgriSucreAuditoriaTransaction agriSucreAuditoriaTransaction2 = new AgriSucreAuditoriaTransaction();
-						agriSucreAuditoria2.setCanal(cotizacionC.getPuntoVenta().getNombre());
-						agriSucreAuditoria2.setEstado("INI_NOTIF");
-						agriSucreAuditoria2.setFecha(fechaActual);
-						agriSucreAuditoria2.setObjeto("Ingresa al proceso cambio de estado");
-						agriSucreAuditoria2.setTramite(cotizacionC.getNumeroTramite());
-						agriSucreAuditoriaTransaction2.crear(agriSucreAuditoria2);
-						//fin de auditoria
-					
-					
-					if (cotizacionC.getId() != null) {
-						CotizacionAprobacionDAO cDAO = new CotizacionAprobacionDAO();
-						Estado estadoPendiente = estadoDAO.buscarPorNombre("Pendiente de Emitir", "Cotizacion");
-						AgriCotizacionAprobacion cotAct = cDAO.buscarPorId(cotizacionC.getId());
-						if (cotizacionC.getEstado().getId().equals(estadoPendiente.getId()))
-							mensaje = mensaje + " la cotización ya fue aprobada anteriormente,";
-						estadoPendiente = estadoDAO.buscarPorNombre("Pendiente Aprobar", "Cotizacion");
-						if (!cotizacionC.getEstado().getId().equals(estadoPendiente.getId())){
-							estadoPendiente = estadoDAO.buscarPorId(cotizacionC.getEstado().getId());
-							mensaje = mensaje + " la cotización se encuentra en estado "+estadoPendiente.getNombre()+",";
+						try{
+							AgriSucreAuditoria agriSucreAuditoria2 = new AgriSucreAuditoria();
+							AgriSucreAuditoriaTransaction agriSucreAuditoriaTransaction2 = new AgriSucreAuditoriaTransaction();
+							agriSucreAuditoria2.setCanal(cotizacionC.getPuntoVenta().getNombre());
+							agriSucreAuditoria2.setEstado("INI_NOTIF");
+							agriSucreAuditoria2.setFecha(fechaActual);
+							agriSucreAuditoria2.setObjeto("Ingresa al proceso cambio de estado");
+							agriSucreAuditoria2.setTramite(cotizacionC.getNumeroTramite());
+							agriSucreAuditoriaTransaction2.crear(agriSucreAuditoria2);
+						}catch(Exception e){
+							e.printStackTrace();
+						}
+						//fin de auditoria					
+						if (cotizacionC.getId() != null) {//VERIFICACION DE LA COTIZACION EXISTE
+							CotizacionAprobacionDAO cDAO = new CotizacionAprobacionDAO();
+							//Verifica si la cotizacion esta cambiada de estado
+							Estado estadoPendiente = estadoDAO.buscarPorNombre("Pendiente de Emitir", "Cotizacion");
+							AgriCotizacionAprobacion cotAct = cDAO.buscarPorId(cotizacionC.getId());//se trae la vista con todos los datos de la cotizacion.
+							/***VALIDACIONES PREVIOS AL CAMBIO DE ESTADO***/
+							if (cotizacionC.getEstado().getId().equals(estadoPendiente.getId()))
+								mensaje = mensaje + " la cotización ya fue aprobada anteriormente,";
+							estadoPendiente = estadoDAO.buscarPorNombre("Pendiente Aprobar", "Cotizacion");
+							if (!cotizacionC.getEstado().getId().equals(estadoPendiente.getId())){//si la cotizacion no se encuentra en otro estado que no sea pendientede emitir
+								estadoPendiente = estadoDAO.buscarPorId(cotizacionC.getEstado().getId());
+								mensaje = mensaje + " la cotización se encuentra en estado "+estadoPendiente.getNombre()+",";
 							}
@@ -1215,80 +1138,119 @@
 							}
-						if (cotAct.getTipoCultivoId()==null)
-							mensaje = mensaje + " no existe tipo de cultivo,";
-						if (cotAct.getSumaAseguradaTotal()==0 || (Float)cotAct.getSumaAseguradaTotal()==null)
-							mensaje = mensaje + " la suma asegurada no puede ser (0),";
-						if (cotAct.getPrimaNetaTotal()==0 || (Float)cotAct.getPrimaNetaTotal()==null)
-							mensaje = mensaje + " la prima neta total no puede ser (0),";
-						if (cotAct.getTasa()==0 || (Float)cotAct.getTasa()== null)
-							mensaje = mensaje + " la tasa no puede ser (0),";
-						if (cotAct.getSeguroBancos()==0 || (Float)cotAct.getSeguroBancos()==null)
-							mensaje = mensaje + " el impuesto super bancos no puede ser (0),";
-						if (cotAct.getSeguroCampesino()==0 || (Float)cotAct.getSeguroCampesino()==null)
-							mensaje = mensaje + " el impuesto seguro campesino no puede ser (0),";
-						//se retira validacion
-//						if (cotAct.getDerechoEmision()==0 || (Float)cotAct.getDerechoEmision()==null)
-//							mensaje = mensaje + " el impuesto derecho de emisión no puede ser (0),";
-						if (cotAct.getTotalFactura()==0 || (Float)cotAct.getTotalFactura()==null)
-							mensaje = mensaje + " el total factura no puede ser (0),";
-						if (mensaje.equals("")) {
-							// Cambiar estados originalmente aquí
-							//cotizacionC.setEstado(estadoDAO.buscarPorNombre("Pendiente de Emitir","Cotizacion"));
-							
-							// /TODO:Si es canal sucre consumir el servicio web
-							// /Integracion con Canal sucre
-							AgriParametroXPuntoVentaDAO canalNotificacionDAO = new AgriParametroXPuntoVentaDAO();
-							AgriParametroXPuntoVenta canalNotificacion = canalNotificacionDAO.buscarPorPuntoVentaId(new BigInteger (cotizacionC.getPuntoVenta().getId()));
-							///Forma de notificacion canal
-							
-							//Auditoria Inicia el proceso de cotizacion:
-							//para saber a que hora se hizo la notificacion
-							AgriSucreAuditoria agriSucreAuditoria3 = new AgriSucreAuditoria();
-							AgriSucreAuditoriaTransaction agriSucreAuditoriaTransaction3 = new AgriSucreAuditoriaTransaction();
-							agriSucreAuditoria3.setCanal(cotizacionC.getPuntoVenta().getNombre());
-							agriSucreAuditoria3.setEstado("INI_NOTIF");
-							agriSucreAuditoria3.setFecha(fechaActual);
-							agriSucreAuditoria3.setObjeto("Ingresa al proceso de notificacion");
-							agriSucreAuditoria3.setTramite(cotizacionC.getNumeroTramite());
-							agriSucreAuditoriaTransaction3.crear(agriSucreAuditoria3);
-							//fin de auditoria
-							
-							/// 1) Ninguno, 2 )Web Service(Sucre) 3) mail (offline)
-							if (canalNotificacion.getFormaNotificacion() == 2) {
-								if (cotizacionC.getNumeroTramite() != null) {
-								AgriSucreRespuesta sucre = new AgriSucreRespuesta();
-								//TODO: Se envia la misma suma asegurada al no haber recalculo de valores
-								String suma=""+cotAct.getSumaAseguradaTotal();
-								double sumaA=Double.parseDouble(suma);
-								SdtEstado datos = ObjetoSucre(cotAct,sumaA,"APROBADO");
-								PQBE_wsACTUALIZAESTADOResponse resultado = sucre.RespuestaSucre(cotizacionC.getNumeroTramite(), datos);
-								
-								if (resultado != null) {
-									//TODO: Cargar el log de respuesta de sucre una vez que recibo el resultado
-									auditoria = new AgriSucreAuditoria();
-									auditoria.setTramite(cotizacionC.getNumeroTramite());
-									String h=""+resultado.getRespuesta().isHuboErrores();
-									DatosRecibidos= "Recibido - Observaciones"+resultado.getRespuesta().getObservaciones()+h;
-									auditoria.setObjeto(DatosRecibidos);
-									auditoria.setFecha(VigenciaDesde);
-									auditoria.setCanal("SUCRE");
-									auditoria.setEstado("APROBACION");
-									procesoAuditoria.crear(auditoria);
-									
-									if (resultado.getRespuesta().getObservaciones().toUpperCase().equals("OK")) {
-										DatosRecibidos = DatosRecibidos+ "Aprobación "+resultado.getRespuesta().getObservaciones().toUpperCase();
-
-										// TODO:Actualiza estado tabla cotizacion
-										cotizacionC.setVigenciaDesde(VigenciaDesde);
-										cotizacionC.setFechaEmision(FechaEmision);
-										// Cambiar estados
-										cotizacionC.setEstado(estadoDAO.buscarPorNombre("Pendiente de Emitir","Cotizacion"));
-										
-										cotizacionC = cotizacionTransaction.editar(cotizacionC);
-										
-										// /TODO: Auditoria de aprobaciones y
-										// rechazos
-										RegistrarAuditoriaCotizacion(new BigInteger(cotizacionC.getId()),new BigInteger(usuario.getId()),"APROBADO REVISION");
-										
-										//registro el detalle de la cotizacion
+							if (cotAct.getTipoCultivoId()==null)
+								mensaje = mensaje + " no existe tipo de cultivo,";
+							if (cotAct.getSumaAseguradaTotal()==0 || (Float)cotAct.getSumaAseguradaTotal()==null)
+								mensaje = mensaje + " la suma asegurada no puede ser (0),";
+							if (cotAct.getPrimaNetaTotal()==0 || (Float)cotAct.getPrimaNetaTotal()==null)
+								mensaje = mensaje + " la prima neta total no puede ser (0),";
+							if (cotAct.getTasa()==0 || (Float)cotAct.getTasa()== null)
+								mensaje = mensaje + " la tasa no puede ser (0),";
+							if (cotAct.getSeguroBancos()==0 || (Float)cotAct.getSeguroBancos()==null)
+								mensaje = mensaje + " el impuesto super bancos no puede ser (0),";
+							if (cotAct.getSeguroCampesino()==0 || (Float)cotAct.getSeguroCampesino()==null)
+								mensaje = mensaje + " el impuesto seguro campesino no puede ser (0),";
+							if (cotAct.getTotalFactura()==0 || (Float)cotAct.getTotalFactura()==null)
+								mensaje = mensaje + " el total factura no puede ser (0),";
+							if (mensaje.equals("")) {
+								///TODO:Si es canal sucre consumir el servicio web
+								///Integracion con Canal sucre
+								AgriParametroXPuntoVentaDAO canalNotificacionDAO = new AgriParametroXPuntoVentaDAO();
+								AgriParametroXPuntoVenta canalNotificacion = canalNotificacionDAO.buscarPorPuntoVentaId(new BigInteger (cotizacionC.getPuntoVenta().getId()));
+								try{
+									//para saber a que hora se hizo la notificacion
+									AgriSucreAuditoria agriSucreAuditoria3 = new AgriSucreAuditoria();
+									AgriSucreAuditoriaTransaction agriSucreAuditoriaTransaction3 = new AgriSucreAuditoriaTransaction();
+									agriSucreAuditoria3.setCanal(cotizacionC.getPuntoVenta().getNombre());
+									agriSucreAuditoria3.setEstado("INI_NOTIF");
+									agriSucreAuditoria3.setFecha(fechaActual);
+									agriSucreAuditoria3.setObjeto("Ingresa al proceso de notificacion");
+									agriSucreAuditoria3.setTramite(cotizacionC.getNumeroTramite());
+									agriSucreAuditoriaTransaction3.crear(agriSucreAuditoria3);
+								}catch(Exception e){
+									e.printStackTrace();
+								}
+								/***FORMAS DE NOTIFICACION DE LAS APROBACION DEPENDIENDO DEL CANAL, CONFIGURACION EN BASE***/
+								/// 1) Ninguno, 2 )Web Service(Sucre) 3) mail (offline)
+								if (canalNotificacion.getFormaNotificacion() == 2) {
+									if (cotizacionC.getNumeroTramite() != null) {
+										AgriSucreRespuesta sucre = new AgriSucreRespuesta();
+										String suma=""+cotAct.getSumaAseguradaTotal();
+										double sumaA=Double.parseDouble(suma);
+										SdtEstado datos = ObjetoSucre(cotAct,sumaA,"APROBADO");
+										PQBE_wsACTUALIZAESTADOResponse resultado = sucre.RespuestaSucre(cotizacionC.getNumeroTramite(), datos);									
+										if (resultado != null) {
+											try{
+												//TODO: Cargar el log de respuesta de sucre una vez que recibo el resultado
+												auditoria = new AgriSucreAuditoria();
+												auditoria.setTramite(cotizacionC.getNumeroTramite());
+												String h=""+resultado.getRespuesta().isHuboErrores();
+												DatosRecibidos= "Recibido - Observaciones"+resultado.getRespuesta().getObservaciones()+h;
+												auditoria.setObjeto(DatosRecibidos);
+												auditoria.setFecha(VigenciaDesde);
+												auditoria.setCanal("SUCRE");
+												auditoria.setEstado("APROBACION");
+												procesoAuditoria.crear(auditoria);
+											}catch(Exception e){
+												e.printStackTrace();
+											}
+											/***ACTUAMOS DEPENDIENDO DEL RESULTADO***/
+											if (resultado.getRespuesta().getObservaciones().toUpperCase().equals("OK")) {
+												DatosRecibidos = DatosRecibidos+ "Aprobación "+resultado.getRespuesta().getObservaciones().toUpperCase();
+												// Cambiar estados
+												cotizacionC.setEstado(estadoDAO.buscarPorNombre("Pendiente de Emitir","Cotizacion"));
+												cotizacionC = cotizacionTransaction.editar(cotizacionC);
+												///TODO: Auditoria de aprobaciones y rechazos
+												RegistrarAuditoriaCotizacion(new BigInteger(cotizacionC.getId()),new BigInteger(usuario.getId()),"APROBADO REVISION");
+												//registro el detalle de la cotizacion para conocer los movimientos
+												try{
+													AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+													agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");
+												}catch(Exception e){
+													e.printStackTrace();
+												}											
+												mensaje = "La Cotización ha sido aprobada correctamente";
+											} else {
+												String mensajeEstado = resultado.getRespuesta().getObservaciones();
+												String erroresCadena="";
+												SdtResponseQBEErroresItem[] error = resultado.getRespuesta().getErrores();
+												for (SdtResponseQBEErroresItem item : error){
+													String[] erroresU= item.getError().getErrorB();
+													for (String er : erroresU)
+													erroresCadena = erroresCadena+ er+" ";
+												}
+												DatosRecibidos = DatosRecibidos+ mensajeEstado+" "+erroresCadena;
+												mensaje = "No se ha podido aprobar. " + mensajeEstado+" "+erroresCadena+ " ";
+											}
+										} else {
+											 String ms = "No se obtuvo respuesta de confirmación de Sucre.";
+											 DatosRecibidos = DatosRecibidos+ ms;
+											 mensaje = ms+" Por favor vuelva a intentar más tarde.";
+										}
+										//TODO: Cargar el log de respuesta de sucre para probacion o rechazo
+										try{
+											auditoria = new AgriSucreAuditoria();
+											auditoria.setTramite(cotizacionC.getNumeroTramite());
+											auditoria.setObjeto(DatosRecibidos);
+											auditoria.setFecha(VigenciaDesde);
+											auditoria.setCanal("SUCRE");
+											auditoria.setEstado("APROBACION");
+											procesoAuditoria.crear(auditoria);
+										}catch(Exception e){
+											e.printStackTrace();
+										}
+									} else {
+										mensaje = "No se ha podido aprobar. La cotización no tiene número de tramite. ";
+									}
+								}
+								else {
+									///Actualiza estado tabla cotizacion
+									Estado nuevoAprodo = new Estado();
+									EstadoDAO estadoDAo = new EstadoDAO();
+									nuevoAprodo=estadoDAo.buscarPorNombre("Pendiente de Emitir","Cotizacion");
+									cotizacionC.setEstado(nuevoAprodo);
+									cotizacionC = cotizacionTransaction.editar(cotizacionC);									
+									///TODO: Auditoria de aprobaciones y rechazos
+									RegistrarAuditoriaCotizacion(new BigInteger(cotizacionC.getId()), new BigInteger(usuario.getId()), "APROBADO REVISION");
+									//Registro el endoso
+									try{
 										AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
 										agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");
@@ -1293,16 +1255,5 @@
 										AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
 										agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");
-										
-										mensaje = "La Cotización ha sido aprobada correctamente";
-									} else {
-										String mensajeEstado = resultado.getRespuesta().getObservaciones();
-										String erroresCadena="";
-										SdtResponseQBEErroresItem[] error = resultado.getRespuesta().getErrores();
-										for (SdtResponseQBEErroresItem item : error){
-											String[] erroresU= item.getError().getErrorB();
-											for (String er : erroresU)
-											erroresCadena = erroresCadena+ er+" ";
-										}
-										DatosRecibidos = DatosRecibidos+ mensajeEstado+" "+erroresCadena;
-										mensaje = "No se ha podido aprobar. " + mensajeEstado+" "+erroresCadena+ " ";
+									}catch(Exception e){
+										e.printStackTrace();
 									}
@@ -1308,18 +1259,4 @@
 									}
-								} else {
-									 String ms = "No se obtuvo respuesta de confirmación de Sucre.";
-									 DatosRecibidos = DatosRecibidos+ ms;
-									 mensaje = ms+" Por favor vuelva a intentar más tarde.";
-								}
-								//TODO: Cargar el log de respuesta de sucre para probacion o rechazo
-								auditoria = new AgriSucreAuditoria();
-								auditoria.setTramite(cotizacionC.getNumeroTramite());
-								auditoria.setObjeto(DatosRecibidos);
-								auditoria.setFecha(VigenciaDesde);
-								auditoria.setCanal("SUCRE");
-								auditoria.setEstado("APROBACION");
-								procesoAuditoria.crear(auditoria);
-								} else {
-									mensaje = "No se ha podido aprobar. La cotización no tiene número de tramite. ";
+									mensaje = "La cotización ha sido aprobada correctamente.";
 								}
 							}
@@ -1324,22 +1261,14 @@
 								}
 							}
-							////////////////////////////////////////////////////////////////
-							else {
-								// / Actualiza estado tabla cotizacion
-								Estado nuevoAprodo = new Estado();
-								EstadoDAO estadoDAo = new EstadoDAO();
-								nuevoAprodo=estadoDAo.buscarPorNombre("Pendiente de Emitir","Cotizacion");
-								cotizacionC.setEstado(nuevoAprodo);
-								cotizacionC.setVigenciaDesde(VigenciaDesde);
-								cotizacionC = cotizacionTransaction.editar(cotizacionC);
-
-								// /TODO: Auditoria de aprobaciones y rechazos
-								RegistrarAuditoriaCotizacion(new BigInteger(cotizacionC.getId()), new BigInteger(usuario.getId()), "APROBADO REVISION");
-								// /TODO: Mensajes del estado de la cotizacion
-								//registro el detalle de la cotizacion
-								AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-								agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");
-								
-								mensaje = "La cotización ha sido aprobada correctamente.";
-							}
+							else 
+								mensaje = "La cotización no se ha podido aprobar: "+mensaje.substring(0,mensaje.length()-1);							
+								detalleProceso.put("cotizacion", cotizacionC.getId());
+								detalleProceso.put("detalle", mensaje);
+								detalleProcesoList.add(detalleProceso);
+								// Enviar mail aprobacion pre- poliza si viene del offline
+								if (cotAct.getTipoOrigen()!=null && cotAct.getTipoOrigen().equals("COTIZADOR_OFFLINE")) {								
+									EnviarMailCambioEstadoBlob(cotizacionC, cotAct,"AP");
+								}
+						} else {
+							mensaje = ("No se pudo aprobar la cotización, la cotización no se encuentra registrada.");							
 						}
@@ -1345,20 +1274,2 @@
 						}
-						else 
-							mensaje = "La cotización no se ha podido aprobar: "+mensaje.substring(0,mensaje.length()-1);
-						detalleProceso.put("cotizacion", cotizacionC.getId());
-						detalleProceso.put("detalle", mensaje);
-						detalleProcesoList.add(detalleProceso);
-
-						// Enviar mail aprobacion pre- poliza si viene del offline
-						if (cotAct.getTipoOrigen()!=null && cotAct.getTipoOrigen().equals("COTIZADOR_OFFLINE")) {
-							
-							EnviarMailCambioEstadoBlob(cotizacionC, cotAct,"AP");
-							//registro el detalle de la cotizacion
-							AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-							agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");
-						}
-					} else {
-						mensaje = ("No se pudo aprobar la cotización, la cotización no se encuentra registrada.");
-						throw new Exception();
-					}
 				} catch (Exception e) {
@@ -1364,5 +1275,4 @@
 				} catch (Exception e) {
-					// BigInteger id = new BigInteger(nuevaCotizacion.getId());
 					detalleProceso.put("cotizacion", nuevaCotizacion.getId());
 					detalleProceso.put("detalle", mensaje+"Se ha producido un error: "+e.getMessage());
 					detalleProcesoList.add(detalleProceso);
@@ -1366,7 +1276,8 @@
 					detalleProceso.put("cotizacion", nuevaCotizacion.getId());
 					detalleProceso.put("detalle", mensaje+"Se ha producido un error: "+e.getMessage());
 					detalleProcesoList.add(detalleProceso);
+					e.printStackTrace();					
 				}
 			}
 		} catch (Exception e) {
 			System.out.println(e.getMessage());
@@ -1369,7 +1280,8 @@
 				}
 			}
 		} catch (Exception e) {
 			System.out.println(e.getMessage());
+			e.printStackTrace();
 		} finally {
 			return detalleProcesoList;
 		}
@@ -1426,9 +1338,14 @@
 								cotizacionC = cotizacionCDAO.buscarPorId(cotizacionC.getId());
 								String row = cotizacionC.getNumeroFactura()+ " , " + cotizacionC.getTotalFactura()+ "\r\n";
 								cadenaArchivo = cadenaArchivo + row;
-								//registro el detalle de la cotizacion
-								AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-								agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");
+								
+								try{
+									//registro el detalle de la cotizacion
+									AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+									agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");
+								}catch(Exception e){
+									e.printStackTrace();
+								}
 								mensaje = "La cotización ha sido emitida correctamente. ";
 								estado="OK";
 							} else {
@@ -1507,9 +1424,13 @@
 						// /TODO: Auditoria de aprobaciones y rechazos
 						RegistrarAuditoriaCotizacion(new BigInteger(cotizacionC.getId()),new BigInteger(usuario.getId()),"REVOCADO REVISION");
 						
-						//registro el detalle de la cotizacion
-						AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-						agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");		
+						try{
+							//registro el detalle de la cotizacion
+							AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+							agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");		
+						}catch(Exception e){
+							e.printStackTrace();
+						}
 						mensaje = "La cotización ha sido revocada. ";
 						estado="OK";
 						
@@ -1700,7 +1621,7 @@
 		}  
 	}
 	
-	public SdtEstado ObjetoSucre(AgriCotizacionAprobacion cotAct,double SumaAseguradaTotal,String estado){
+	public SdtEstado ObjetoSucre(AgriCotizacionAprobacion cotAct,double SumaAseguradaTotal,String estado)throws Exception{
 		Calendar fechaAprobacion = Calendar.getInstance();
 		SdtEstado datos = new SdtEstado();
 		datos.setAutorizacion(Integer.parseInt(cotAct.getId().toString()));
diff --git a/src/com/qbe/cotizador/servlets/producto/agricola/AgriCotizacionDetalleProcesos.java b/src/com/qbe/cotizador/servlets/producto/agricola/AgriCotizacionDetalleProcesos.java
--- a/src/com/qbe/cotizador/servlets/producto/agricola/AgriCotizacionDetalleProcesos.java
+++ b/src/com/qbe/cotizador/servlets/producto/agricola/AgriCotizacionDetalleProcesos.java
@@ -18,7 +18,7 @@
 
 public class AgriCotizacionDetalleProcesos {
 
-	public void creardetalleCotizacion(Cotizacion cotizacion,String proceso){
+	public void creardetalleCotizacion(Cotizacion cotizacion,String proceso)throws Exception{
 		/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
 		AgriCotizacionAprobacion agriCotizacionAprobacion = new AgriCotizacionAprobacion();
 		CotizacionAprobacionDAO cotizacionAprobacionDAO = new CotizacionAprobacionDAO();
diff --git a/src/com/qbe/cotizador/servlets/producto/agricola/AgriEcuaquimicaController.java b/src/com/qbe/cotizador/servlets/producto/agricola/AgriEcuaquimicaController.java
--- a/src/com/qbe/cotizador/servlets/producto/agricola/AgriEcuaquimicaController.java
+++ b/src/com/qbe/cotizador/servlets/producto/agricola/AgriEcuaquimicaController.java
@@ -786,10 +786,14 @@
 						agriAuditoriaCotizacionTransaction.crear(agriAuditoriaCotizacion);
 					}
 					
-					/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
-					AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
-					agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion, "Registro Solicitud");
-					/**FIN DE REGISTRO DE ENDOSO**/
+					try{
+						/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
+						AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
+						agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion, "Registro Solicitud");
+						/**FIN DE REGISTRO DE ENDOSO**/
+					}catch(Exception e){
+						e.printStackTrace();
+					}
 					
 					auditoria.setEstado(EstadoAuditoria);
 					procesoAuditoria.editar(auditoria);
