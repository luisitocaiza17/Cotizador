diff --git a/WebContent/dashboard/AgriParametroPorCanal.jsp b/WebContent/dashboard/AgriParametroPorCanal.jsp
--- a/WebContent/dashboard/AgriParametroPorCanal.jsp
+++ b/WebContent/dashboard/AgriParametroPorCanal.jsp
@@ -24,6 +24,12 @@
 <script src="../static/js/Kendo/kendo.web.min.js"></script>
 
 <style type="text/css">
+.modal .modal-dialog {
+	width: 80%;
+}
+.modal-body {
+    height:80%; 
+}
 .tab_strip {
 	height: 200px;
 }
@@ -184,6 +190,8 @@
 							var allLiElementsToBeRemoved = up.wrapper.find('.k-file');
 							up._removeFileEntry(allLiElementsToBeRemoved );	
 							$("#soloActulizar").hide();
+							$("#cajaTexto").hide();
+							$("#mensajeTexto").hide();
 							limpiar();
 						});
 
@@ -320,7 +328,8 @@
 
 	function actualizar(parametroId) {
 		$("#soloActulizar").show();
-		
+		$("#cajaTexto").show();
+		$("#mensajeTexto").show();
 		var up = $('#files').data().kendoUpload;
 		var allLiElementsToBeRemoved = up.wrapper.find('.k-file');
 		up._removeFileEntry(allLiElementsToBeRemoved );	
@@ -407,6 +416,8 @@
 	
 	function actualizarPorCanalCultivo(parametroCanalId,parametroCultivoId) {
 		$("#soloActulizar").show();
+		$("#cajaTexto").show();
+		$("#mensajeTexto").show();
 		limpiar();
 		if ((parametroCanalId === '' || typeof parametroCanalId === 'undefined') || (parametroCultivoId === '' || typeof parametroCultivoId === 'undefined'))
 			return false;
@@ -503,7 +514,7 @@
 								<input type="hidden" class="form-control" id="id">
 								<table style="width: 100%">
 									<tr>
-										<td>
+										<td width="45%">
 											<label style="width: 100%">Punto de Venta:</label>
 											<select id="canal" name="canal" data-placeholder="Seleccione una opción..." validationMessage="Campo requerido!!!" required="required" required>
 										</select></td>
@@ -507,14 +518,10 @@
 											<label style="width: 100%">Punto de Venta:</label>
 											<select id="canal" name="canal" data-placeholder="Seleccione una opción..." validationMessage="Campo requerido!!!" required="required" required>
 										</select></td>
-									</tr>
-									<tr>
-										<td><br /></td>
-									</tr>
-									<tr>
-										<td>
+										<td width="10%"></td>
+										<td width="45%">
 											<label style="width: 100%">Tipo Cultivo:</label>
 											<select id="tipoCultivo" name="tipoCultivo" data-placeholder="Seleccione una opción..." validationMessage="Campo requerido!!!" required="required" required>
 											</select>
 										</td>
 									</tr>
@@ -516,6 +523,7 @@
 											<label style="width: 100%">Tipo Cultivo:</label>
 											<select id="tipoCultivo" name="tipoCultivo" data-placeholder="Seleccione una opción..." validationMessage="Campo requerido!!!" required="required" required>
 											</select>
 										</td>
 									</tr>
+									
 									<tr>
@@ -521,8 +529,5 @@
 									<tr>
-										<td><br /></td>
-									</tr>
-									<tr>
-										<td>
+										<td width="45%">
 											<label style="width: 100%">Nombre Plantilla:</label>
 											<input type="text" id="plantillaNombre" name="plantillaNombre" class="form-control" >
 										</td>
@@ -526,7 +531,12 @@
 											<label style="width: 100%">Nombre Plantilla:</label>
 											<input type="text" id="plantillaNombre" name="plantillaNombre" class="form-control" >
 										</td>
+										<td width="10%"></td>
+										<td width="45%">
+											<label style="width: 100%">Plantilla ENSURANCE ID:</label>
+											<input type="number" id="plantillaId" name="plantillaId" class="form-control" >
+										</td>
 									</tr>
 									<tr>
 										<td><br /></td>
 									</tr>
@@ -529,5 +539,6 @@
 									</tr>
 									<tr>
 										<td><br /></td>
 									</tr>
+									
 									<tr>
@@ -533,5 +544,5 @@
 									<tr>
-										<td>
-											<label style="width: 100%">Plantilla ENSURANCE ID:</label>
-											<input type="number" id="plantillaId" name="plantillaId" class="form-control" >
+										<td width="45%">
+											<label style="width: 100%">Numero Contenedor:</label>
+											<input type="text" id="sucursalEmisionId" name="sucursalEmisionId" class="form-control" >
 										</td>
@@ -537,8 +548,7 @@
 										</td>
-									</tr>
-									<tr>
-										<td>
+										<td width="10%"> </td>
+										<td width="45%">
 											<label style="width: 100%">Contenedor ENSURANCE ID:</label>
 											<input type="number" id="contenedorId" name="contenedorId" class="form-control" >
 										</td>
 									</tr>
@@ -541,5 +551,6 @@
 											<label style="width: 100%">Contenedor ENSURANCE ID:</label>
 											<input type="number" id="contenedorId" name="contenedorId" class="form-control" >
 										</td>
 									</tr>
+									
 									<tr>
@@ -545,11 +556,5 @@
 									<tr>
-										<td>
-											<label style="width: 100%">Numero Contenedor:</label>
-											<input type="text" id="sucursalEmisionId" name="sucursalEmisionId" class="form-control" >
-										</td>
-									</tr>
-									<tr id="soloActulizar">
-										<td>
+										<td id="soloActulizar">
 											<label style="width: 100%">PLANTILLA ACTUAL:</label>
 											<button type="button" class="btn btn-default" id="plantillaActual" onclick="descargarPlantilla();" name="plantillaActual" >descargar</button>
 										</td>
@@ -553,9 +558,8 @@
 											<label style="width: 100%">PLANTILLA ACTUAL:</label>
 											<button type="button" class="btn btn-default" id="plantillaActual" onclick="descargarPlantilla();" name="plantillaActual" >descargar</button>
 										</td>
-									</tr>
-									<tr>
-										<td>
+										<td ></td>
+										<td >
 											<div class="row" style="display: inline;" id="content-Upload">
 											<div class="col-lg-12">
 												<div class="table-responsive">
@@ -579,7 +583,8 @@
 										</div>
 										</td>
 									</tr>
-									<tr>
-										<td colspan="4">Texto:
+									
+									<tr id="mensajeTexto">
+										<td colspan="4"><h3>Texto:</h3>
 										</td>
 									</tr>
@@ -584,10 +589,9 @@
 										</td>
 									</tr>
-									<tr>
-										<td colspan="4"><textarea id="texto" rows="10" cols="30"
-									style="height: 100%; width: 100%; max-width: 400px;"
-									class="form-control required"></textarea>
-										</td>
+									<tr id="cajaTexto">
+										<td colspan="4"><textarea id="texto" rows="30" cols="30"
+												style="height: 500px; width: 100%; max-width: 600px;"
+												class="form-control"></textarea></td>
 									</tr>
 									
 									<tr>
diff --git a/build/classes/com/qbe/cotizador/model/Cliente.class b/build/classes/com/qbe/cotizador/model/Cliente.class
index a726db7131b3793cd13a36e1be2832277eb944a6..c866b59b23883a6c1d05180f27e0a6d4a62941cc
GIT binary patch
literal 2569
zc$|e*ZFAE`5Z()ZA*pGIaY6|tnAbWXL=b2ThNPs90uD|>Y?BV*Lq?Ww%rUkOBsp#R
zoBE-hDbtyL=nv?R>hw8DR$BR-c*Z{M-m}j>y4^kh{m-9&5zzyBoux5GS8drdKDM}F
zOJDqKwWVwHWSe)5N>^~l=UGZII{)4}w2ZFhbc~(Wdv5z#$}lPfULlPJcZJnObgRn&
z_5yQ{yPlBF>*_iqw#n#RMLM2uIsTs2?ejE+AI4}*v>D}V$0-`VE1b>~MwjY+#}_@m
zCp-b_HOG;@<%85?G!q2;WPDI*JfAx@H>zy}UDs?p=MHx*pSOeD0G;)GWp|EF#3NJl
z=tF?7uAAG<YV!@FjAi@cP~xTb8D()qqHW;?uGK~zq!~iMaz&GB%W{sIa>r3w@&UC1
zo3?ahPuLct#gW8oLuhc!X>x2z;Z$U|-*W&+IaUu<nu&8A@Im;2s>BpZBszVLou~yE
z&1y(v!u)Z-fjx-GJQa@cR~elt&F>*;1&Sx=4Bg7nHM-7dvL+n9-S4%y+YH+#Uz0Yv
z#zODFj+`m~o$yXN+(;s1q&wWNLVuw&Kio^>#OQ90a&!(rF9c4PhH*;kIEdDw8bkfQ
zihYoy0!?GjJKjr`_7!{raC6WFH<0|aK2Us*b2LL25$ydZ_-5(USe0;kpfAxVODE*k
zw2G4PU5+l%EGRuar7>EOhEa(tC~?UKQmNK+G^b9#;AsFjh=%ODHs27c>bc0hr0S#Z
zK6N1e5z1cFY;L2&+q->SL)=rHaj2$VKN>Mqaa|bXZS_6da$iYT^-21p+GcdSVb;t_
zvuGDL>N{J-2n+MacihFgB-$%wH9@mOG*S5!+wy5F(T!4EDVF2QB_XUS+Y(c8aRe3W
z`G0)av50s$D)|pD%({u>;oVkTDdWgw6o-MuAmE#(49!xO&f<9-clQ`g;ES1p{W<I@
zSd&=K!=B=lrwedkYyv3SJ%VMhei8W4dy#JvmhxSO{iR1&V9v$7pJBZkZWIFpHwb=j
z1pi{Vhq0y?{-B$`1*Es}t8@{~Q;HVoD?H^w5S8G=e-6BNA_5~O_?;GijR`V=^R6~{
zDF{-*t3aznnT0!_Xfc`oK4O*whM5o*F{r2T&=}nVYFNnfF9{)EYlS?7KPlw$Ct6Ml
zd5oCy2qCIGD)Be;twzYB<cX|kg_P-u?nE9Xg{&dw`w>FI{$TVJIfjL-CWV+<A<vLP
zBV;uxq>7l$5kkVIWDu(BkxEj?mR5+V?~zJU$Sz{)BZPzlFh(0e%=2IrUgGIR@B)lB
f-%{#X;K5+jXv?GR*xXU(tJvICW<53=%544%7qTs#

diff --git a/build/classes/com/qbe/cotizador/model/Entidad.class b/build/classes/com/qbe/cotizador/model/Entidad.class
index 42d023e5650a3e5e678e09c442cf903213126643..2e1a0d26cf4c5e944d2d0dc6463f18d0bc0c925d
GIT binary patch
literal 8970
zc$}43eRLdE6~B`<*(RB!O`4>(HtjYouxV<x_7l?&Xg8aZnx>`Mq*A1DvO7tq?#`q;
zv!OvnQ9)5rQK+JVqEJNzskX&dL=XkVs<kSLiV7;Cf~fqV=jh>h?|kj-oA<Iwdp0}o
zy?cN6_kMHVeedlPubg=Z0M^3G5vY)0Y1+ue509wvv|(x2C>bLk&lwpt8&B$%mQgYh
zm@UD)L&}5_&no&@eD}y9HEl(pN`fZ4S2N-RYF<;a=sl8E(b%+`Lu%gC41KV-TLNjP
z1a%2RH!VfChLmhUtpw+vBteCik)W}!7-GQ6Yx>wG2^Q`xAc>qhq?sB*Z_{<dQY-{D
zC1|l7j>N|)jA^NQT8;N+(5a0xutU|=yke;tJ2o24F)eD3O-^Z#ky4Z6wta7RvOm?E
zx<Z0#Wn9f>wTyuzWL3A4x>?98=q14-4phR(7IHd5%+{40+SH-Tuv+w~8&%T>l|)`u
z(ijd!b%ZbvXX7cHIx3bMNAG&uY&h-P)oU3<(nhtk+c7(*Xj$ynjoe6HO&GcHtZEq&
z%yl}3(|%9H=|TQ;EH$f+8aj2R)odZF<RxhEI+I6m3Z@O-==BY&#m<N_h7<^Ao<q7|
zY1w!m&KwC>4`^e$Vioc@$2H9G<~~u<ZL<+KZAE}qj+nc3HD&Bl^htUpIc0oY&1}b4
z7*U;E#m;nAb2+V@cF=_5V@IvYXn8fAc5-a}v?01ZFB_y<C8-rVMb=FlBk4NX5Ve*z
zZX~^FT_AKy70m>ikz6SQmBaBRobjE8ru#`cm%<Laat_-IlX`lYTw66IpHgc?ZLv{H
z6V?WwQ!ookUNdI&x&|E|Tc)bbnyy(}C72a!AHp?|K#Llf1((XO8Mfej`ZQhbFXTql
ze9Ea#jeSNMixVPH+wGif9n_G+GV#0dC9WJ(tzM+w6l)KctZI<pG8ts3LqpRsY>tKP
zh^vf1+q_ajj=N-NB1hQ_4B!;dE*U5@WO}&_&15>)EFHs@h}J!&6{W>vT3S;GXGn&H
zu*fditk;4V&xwdP*a`&SB|%*&!(yV;V6vmQKG9<rRwuF>mZ6pGBBs;l;PsajEwW3?
zu*AdbXG&U)?_mo!CPS1=YkX6btrl%kZqXv6H_Nb$jB3qdzk`%;3LhC6GPHR}39lYD
z1(5ubNY<td%gMUQ<QO>E+q??d=)Htsja(P%oJM7&$dfW$02ewu{SfnGYy^5+>)GCE
zgdo3`(shE{pu1M8l}yI5lwf<T99VlfgBqO9butuSq88o-*GJ&pxQCT8mf;3?4=!;G
z%q%D8FtVwAe+}FS?~lOyu*6LrPlgY`O^$GWbzLEzg}3fWkt)TVb+p`^a1H0xoH3y~
zZJO9eWcVmeqRJU?@-yLYR_kYw3B~P-QsHAVtfEw)ye{HxnEqQY!qFsaP-M49f^M-e
zo|pLjdKUD8Z<pZ~n5cnI(@Xly6o*bfbR_LPiHouq0S{4*s=jv}irXF7$T!YF-r!bF
z0)JkHP7=7zEXBNd`Vt2r?b44T`+c}$h-EH%iiIxPkkt3ea2HAa6_WaXl&`ECF6m71
zdHFQr;Kt(!9>AdOELlAEY?y)KfrAeT{(uatNpRW+1Be@^uXg~D<gP`zy)FrQrdaKs
zpIB_)gtY#q3@1qIZ;{pyV__)gg(n`>e{3rs1WTbKbP=GLb|cP_tTQGi%{i2j(2vWo
z5iUkZlMfjeE5$)1rR!aCerdg^3@fj`5}hB)um;v5h{=G&rsff>(Nt9j{WIlEs%r66
zNnCy^Lzh=oi+D4rszo@js=7T>R#neSEShIQ>GzZj=P3PtP3iZWDXOX;I#TeS#8uUc
z;8#`OyJo;B<kM=8M#lizmA#V`;a`2p!lJ8Mlrz|mx8cm?1vRg!CLOCM=w{Bpq4=hR
zHQ$RnQZUm>evgr-Lw4n18pc!^NcJTYsc1Udvv>EdsB4SOs}HJqHJa|!GSMy3F1mXx
z<p7oDe~$-d6m%<=Zf7y~U6$ONv@wHz(Jfu<)%?QJP;QG8@e&dJX@^=Y3gw)&JIV#1
z9}y7N`7MFbI%U{}c!2-|_YUzq16P!;avXv`s@PNXTX=-Wb0B^yVLmK^2+YCfY5=H!
z8vNkB3)}VBZot-D{GNyH1{E67yn=35wrR6(R*T;)_*r1Wt8f7CLg9f|<G^Cqv(^1x
z!b4b!15wvtnfu-5elO=atiS<0#^c|MY@?WO(2k##CUjuus(`_3cm|yTgE-G%b->`Y
zJOiw{F1fkbT8H239fBLMi8};;@O9Yi3P5iPL&xy}ui^N2tNn|kg#Q65S3Urj9JhV8
z;a_@j0D~|ahG08B$&L{upqqXlge3I10C6AS1njuq2dJ_;ui!fO!cNzDD_T>as+Aol
zVFw%jD)c#EBeXbHE&@F{StY^ixkUO{A_|vCKc7e+OGHJVQ2~)Am&k4|kv%LCjZ0)N
zpU57TNDh5;0g+~x$N;1`L<U(Rhq*-d!5er)23aBn^qCM4aTctEFQ2E#ewN52m&hCW
zitJ~JybXP>6%bkMDsmN<$N`qfbzCBE;uAT*61g6IZV(V@b%`ikA|ou38@WU>d?F((
zk(<!xg90K;Tp}u$$S6zXW-gI~d?KSPkz3K{sDMb+C8BYO9Ab&w#wC*F6FI~ZxgCA(
z5D;1B63KCi=q!;txkSeKM0A$O-RN^nK%~tja+pgb&l0(ZOT^+6$+JZ6MW6cwM3%cm
z3b??%ZRF|@p(8Az<6J`5z*~Hfx7r|kg2avxu~`9PC(-wmfEew{5-xZz3iZTnO4q{M
z-D&r`=#48+!8<xm!#gWrUk5(Fx1-3n9wP#r#$E9Y9z`AuL~Hb;HR2Nbkd6IeA@<FL
zE%C4)M(jrr`_VGkw*(}<H6-y-R^rFG5`R1(@oiy=kFpZ~0DaF2BwiJgcom*+h|(wE
zlN=d76_EIjkPJUY8P1^$=LIs{37@sGKPSZYBo1RgiP*nD?5E0L-xZMf?vTXCSc#wJ
zO8kX@#P@_HKE_J?4EjDRkhn7>ai>e^i|{3m3||gNd|yb0KcNiIp$yLpWH=6AwXwe@
z#P%c(W50mdFCz9!Ww1{KBt99E_!KMg%Up@S9+3ESSmINx#Q#R${|F>r9g=u8p0SD2
z8TbZAh6e)@KNOPTzbM21P=;3oGCTs`wy_@-VtW#Yu%!y9m1e;_sj>|Aci_96P2n*{
zTB({V?f2mOyiMUTW>b*rpi-(ANa|cTBzOYLN0`W2mPiAa$d9lhaEP2`i8LdT76Fkp
z?v3SKAnAS*B6OZ5w2({aXMv>qc{u6LGf5}4BC#a`VqKx6>%!X?QF;;!RX8zz8A!Tc
zg%V>KCPo`3#tK1VJPp6Kv41DT_L44)9YgGP#O|09y8?c1`#oddAT@k?7Qg?1BY(US
vsxHOKQ$ZKb=itvKJnuLELe0PW&A(Ce1;6<sHUI86U!vwe{N_KY`LF*2F7=xl

diff --git a/build/classes/com/qbe/cotizador/model/ObjetoVehiculo.class b/build/classes/com/qbe/cotizador/model/ObjetoVehiculo.class
index a6a7e2ba0a7e8cc8d801e892ed83a5a4ea105c20..ae45e6cbd6d2b49c35a7508b1d81a0a1c9c702e8
GIT binary patch
literal 10883
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
ah`%q3e-PqxW$}+f{1f~I6SN@ipZ^P7za<a=

diff --git a/build/classes/com/qbe/cotizador/servlets/producto/pymes/ObjetoPymesController.class b/build/classes/com/qbe/cotizador/servlets/producto/pymes/ObjetoPymesController.class
index cccbd34c31309b142ccfd5c109670d7c19576e9f..a2ec8aa141b8ed5e7648848244afa33c40eb7a0c
GIT binary patch
literal 13733
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
J4vLD!{|lm3?Qj49

diff --git a/build/classes/com/qbe/cotizador/util/MotorTarifador.class b/build/classes/com/qbe/cotizador/util/MotorTarifador.class
index 1de5384e9e5ae6c902912f940c53d2068c63345e..8650eb07667105e29a0060b060a64f7f149c018e
GIT binary patch
literal 4324
zc%0=|-A>d%6g~s{$BKd=h~Q6Aksr0a(8R<wCS*~AS%k1FiHR|pw!`jV+p|oko9LDA
z;f0T3qKV#n;dA%|UK*#%vUH`Ab;E+Ly_n8S&-cxl^PM?uzx?>{2>@=v%{258n6c0`
zwoPVODEVt@qc8%=9b*M0iV_ukGn`99g23<=tx?0FUfEbRx0odfr0#K#%licS=jJyE
zB=TspGz<_J+OvHi1d0rtAj#RMo?t#YHD+sS*(!Ia<mhQtfu_S;|E`uDC{>uo-6{$h
zn&`?iz3G{5Q`D8Q9as|e8mn+Ca8Q@KUTPNgJd~QrwB2?71;S$B(nX(@13_)Nw742$
zq)F7MCSO(AADgczNgT{O)aRSrqLvEyI%j?vy9!<OBrgZdruIf72;IT-V(hxRr`}NJ
zsCIEI8IXkxoE(HCoFXtbSJ*41MJc#f&V{9RsK7n;Bydfps<f(}1V##IQD;MynsD5h
zOvnoN3CtGSD)Tu4<BCIthKe=8UAm4YmQYfMz*f|eB@7gOE{4?&cWo2{D-b?)a?8uV
zwb_YJZhk*)2F3|_(Z<W77f=5YWj29{7NzqQ+zwbn>q<vjcck<rf$#sP(gdbk&l>Zq
z==s#-4p&O%d5tS6cxT71BP}ix_;&1C98>-;Q4iOsuy~mN@46H87}7RoVx_wLHx$U8
zehCwpY)Oz3_3KH}D3Q<OQsnUTy{4+e!TKtB!@sv*U5u|Hk2~}>#y0{}`xY&sjXPl_
z@aE70)3JluA_l@@4|(_nG}`)!qlfk|4eFN_!YiYCNl2+Stwy)iEK&FDN60)I$-ald
z&uY{ML#j>fJb_`=4mSFyVMN^rU=+?Y7#0*mvdJ(O!*I3E&{xNug^38Rzll2+gL@gl
zO~LsHF44qYh{3&$;4Xm{!KItH=@{JC2=0pVI&Qt0{W!7^!Og;4?Ed0#cOtlXWxt0@
P9f*6>#1Xh&@7?$bpvr64

diff --git a/src/com/qbe/cotizador/dao/producto/agricola/AgriParametroXCanalDAO.java b/src/com/qbe/cotizador/dao/producto/agricola/AgriParametroXCanalDAO.java
--- a/src/com/qbe/cotizador/dao/producto/agricola/AgriParametroXCanalDAO.java
+++ b/src/com/qbe/cotizador/dao/producto/agricola/AgriParametroXCanalDAO.java
@@ -51,6 +51,12 @@
 		return agriParametroXCanal;
 	}
 	
+	public List<AgriParametroXCanal> ObtenerPorPuntoVenta(BigInteger puntoVentaId)
+	{
+		AgriParametroXCanal agriParametroXCanal = new AgriParametroXCanal();
+		List<AgriParametroXCanal> result = getEntityManager().createNamedQuery("AgriParametroXCanal.buscarPorPuntoVenta").setParameter("puntoVentaId", puntoVentaId).getResultList();
+		return result;
+	}
 	
 	public  List<AgriParametroXCanal>BuscarTodos()
 	{
diff --git a/src/com/qbe/cotizador/model/AgriParametroXCanal.java b/src/com/qbe/cotizador/model/AgriParametroXCanal.java
--- a/src/com/qbe/cotizador/model/AgriParametroXCanal.java
+++ b/src/com/qbe/cotizador/model/AgriParametroXCanal.java
@@ -17,6 +17,7 @@
 @NamedQueries({
 	@NamedQuery(name="AgriParametroXCanal.findAll", query="SELECT a FROM AgriParametroXCanal a ORDER BY a.puntoVentaId, a.tipoCultivoId"),
 	@NamedQuery(name="AgriParametroXCanal.buscarPorId", query="SELECT a FROM AgriParametroXCanal a where a.parametroCanalId=:parametroCanalId"),
+	@NamedQuery(name="AgriParametroXCanal.buscarPorPuntoVenta", query="SELECT a FROM AgriParametroXCanal a where a.puntoVentaId=:puntoVentaId"),
 	@NamedQuery(name="AgriParametroXCanal.obtenerPorCanalTipoCultivo", query="SELECT a FROM AgriParametroXCanal a where a.puntoVentaId=:canalId and a.tipoCultivoId=:tipoCultivoId")
 })
 public class AgriParametroXCanal implements Serializable {
diff --git a/src/com/qbe/cotizador/servlets/producto/agricola/AgriCotizacionAprobacionController.java b/src/com/qbe/cotizador/servlets/producto/agricola/AgriCotizacionAprobacionController.java
--- a/src/com/qbe/cotizador/servlets/producto/agricola/AgriCotizacionAprobacionController.java
+++ b/src/com/qbe/cotizador/servlets/producto/agricola/AgriCotizacionAprobacionController.java
@@ -1376,6 +1376,5 @@
 	}
 
 	public JSONArray procesarEmision(List<Cotizacion> listado,Usuario usuario) {
-		//List<JSONArray> list = new ArrayList<JSONArray>();
 		JSONObject detalleProceso = new JSONObject();
 		JSONArray detalleProcesoList = new JSONArray();
@@ -1380,6 +1379,4 @@
 		JSONObject detalleProceso = new JSONObject();
 		JSONArray detalleProcesoList = new JSONArray();
-		//JSONArray detalleProcesoFile = new JSONArray();
-		String mensaje = "";
-		String estado="";
+		String mensaje = "";	String estado="";
 		String cadenaArchivo = "";
@@ -1385,3 +1382,2 @@
 		String cadenaArchivo = "";
-		//Ruta para grabar archivo 
 		Date fecha = new Date();
@@ -1387,6 +1383,4 @@
 		Date fecha = new Date();
-		//String rutaFile = this.getServletContext().getRealPath("")+ "/static/CotizacionesAprobarMasivo/";
-		//File folder = new File(rutaFile);
 		SimpleDateFormat sm = new SimpleDateFormat("dd/MM/yyyy");
 		DateFormat fHora = new SimpleDateFormat("HH:mm:ss");
 		String nombreArchivo="ArchivoIDsFacturas_"+sm.format(fecha).replace("/", "")+
@@ -1394,7 +1388,6 @@
 		
 		try {
 			for (Cotizacion nuevaCotizacion : listado) {
-				//CotizacionTransaction cotizacionTransaction = new CotizacionTransaction();
 				Cotizacion cotizacionC = new Cotizacion();
 				CotizacionDAO cotizacionCDAO = new CotizacionDAO();
 				mensaje = "";
@@ -1406,8 +1399,6 @@
 						Estado estadoPendiente = estadoDAO.buscarPorNombre("Emitido", "Cotizacion");
 						CotizacionAprobacionDAO cDAO = new CotizacionAprobacionDAO();
 						AgriCotizacionAprobacion cotAct = cDAO.buscarPorId(cotizacionC.getId());
-						//AgriObjetoCotizacionDAO ojtCotiDAO = new AgriObjetoCotizacionDAO();
-						//AgriObjetoCotizacion objCoti = ojtCotiDAO.buscarPorId(cotAct.getObjetoCotizacionId());
 						if (cotAct.getEstadoId().equals(estadoPendiente.getId()))
 							mensaje = mensaje + " la cotización ya fue emitida anteriormente,";
 						estadoPendiente = estadoDAO.buscarPorNombre("Pendiente de Emitir", "Cotizacion");
@@ -1427,11 +1418,9 @@
 						if ((enty.getTelefono()==null || enty.getTelefono().equals("")))
 							if (enty.getCelular()==null || enty.getCelular().equals(""))
 								mensaje = mensaje + " la cotizacion no tiene  teléfono o celular,";					
-						//AgriCotizacionAprobacion cotAct = cDAO.buscarPorId(cotizacionC.getId());
-						
 						if (mensaje.equals("")) {
 							// TODO:LLamar al metodo para emision
 							AgriResultadoEmision resultado = AgriEmisionPoliza.emitirPoliza(cotizacionC.getId());
 
 							if (resultado.isEmitidoCorrectamente()) {
 								cotizacionC = cotizacionCDAO.buscarPorId(cotizacionC.getId());
@@ -1432,16 +1421,8 @@
 						if (mensaje.equals("")) {
 							// TODO:LLamar al metodo para emision
 							AgriResultadoEmision resultado = AgriEmisionPoliza.emitirPoliza(cotizacionC.getId());
 
 							if (resultado.isEmitidoCorrectamente()) {
 								cotizacionC = cotizacionCDAO.buscarPorId(cotizacionC.getId());
-								// Cambiar estados
-								// EstadoDAO estadoDAO = new EstadoDAO();
-								// cotizacionC.setEstado(estadoDAO.buscarPorNombre("Emitido","Cotizacion"));
-								// cotizacionC.setNumeroFactura(resultado);
-								// Actualiza estado tabla cotizacion
-								// cotizacionC =
-								// cotizacionTransaction.editar(cotizacionC);
-								// /TODO Generar cadena para el archivo
 								String row = cotizacionC.getNumeroFactura()+ " , " + cotizacionC.getTotalFactura()+ "\r\n";
 								cadenaArchivo = cadenaArchivo + row;
@@ -1446,6 +1427,5 @@
 								String row = cotizacionC.getNumeroFactura()+ " , " + cotizacionC.getTotalFactura()+ "\r\n";
 								cadenaArchivo = cadenaArchivo + row;
-								
 								//registro el detalle de la cotizacion
 								AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
 								agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");
@@ -1449,8 +1429,6 @@
 								//registro el detalle de la cotizacion
 								AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
 								agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacionC,"Aprobacion");
-								
-								
 								mensaje = "La cotización ha sido emitida correctamente. ";
 								estado="OK";
 							} else {
diff --git a/src/com/qbe/cotizador/servlets/producto/agricola/AgriEmisionPoliza.java b/src/com/qbe/cotizador/servlets/producto/agricola/AgriEmisionPoliza.java
--- a/src/com/qbe/cotizador/servlets/producto/agricola/AgriEmisionPoliza.java
+++ b/src/com/qbe/cotizador/servlets/producto/agricola/AgriEmisionPoliza.java
@@ -76,4 +76,5 @@
 
 public class AgriEmisionPoliza {
 	public static AgriResultadoEmision emitirPoliza(String cotizacionId) throws Exception{
+		//Obtengo la cotizacion
 		CotizacionDAO cotizacionDAO=new CotizacionDAO(); 
@@ -79,2 +80,16 @@
 		CotizacionDAO cotizacionDAO=new CotizacionDAO(); 
+		ClienteDAO clienteDAO = new ClienteDAO();
+		AgriObjetoCotizacionDAO objCotDAO = new AgriObjetoCotizacionDAO();
+		AgriObjetoCotizacion objetoCot = new AgriObjetoCotizacion();
+		CantonDAO cantDAO = new CantonDAO();
+		CiudadDAO ciuDAO = new CiudadDAO();
+		TipoDireccionDAO tipoDirecDAO = new TipoDireccionDAO();
+		ZonaDAO zonaDAO = new ZonaDAO();
+		DireccionTransaction direcTransaccion = new DireccionTransaction();
+		Direccion nuevaDireccion = new Direccion();
+		Date fechaActual = new Date();
+		CotizacionDetalleDAO cotizacionDetalleDAO = new CotizacionDetalleDAO();
+		CotizacionDetalle cotizacionDetalle= new CotizacionDetalle();
+		AgriObjetoCotizacionDAO agriObjetoCotizacionDAO= new AgriObjetoCotizacionDAO();
+		
 		Cotizacion cotizacion=cotizacionDAO.buscarPorId(cotizacionId);
@@ -80,5 +95,3 @@
 		Cotizacion cotizacion=cotizacionDAO.buscarPorId(cotizacionId);
-
-		// Actualizar las direcciones de la entidad cliente
-		ClienteDAO clienteDAO = new ClienteDAO();
+		/**CREACION O ACTUALIZACION DE LA COTIZACION**/
 		Cliente cliente = clienteDAO.buscarPorId(cotizacion.getClienteId().toString());
@@ -84,4 +97,24 @@
 		Cliente cliente = clienteDAO.buscarPorId(cotizacion.getClienteId().toString());
-
-		int Contadordirecciones=cotizacion.getAsegurado().getDireccions().size() ;
+		List<CotizacionDetalle> detalle = cotizacion.getCotizacionDetalles();
+		objetoCot = objCotDAO.buscarPorId(new BigInteger(detalle.get(0).getObjetoId()));
+		Canton canton = cantDAO.buscarPorId(objetoCot.getCantonId().toString());
+		Ciudad ciu = ciuDAO.buscarPorNombre(canton.getNombre());
+		if (ciu==null)
+			ciu = ciuDAO.buscarPorId(canton.getProvincia().getCapitalId());
+		TipoDireccion tipoDirec = tipoDirecDAO.buscarPorId("3");// Por defecto Tipo de direccion (cobro)
+		Zona zona = zonaDAO.buscarPorId("2");// Por defecto zona rural ya que es agricola
+		nuevaDireccion.setCiudad(ciu);
+		nuevaDireccion.setEntidad(cliente.getEntidad());
+		nuevaDireccion.setTipoDireccion(tipoDirec);
+		nuevaDireccion.setZona(zona);
+		nuevaDireccion.setCallePrincipal(objetoCot.getDireccionSiembra());
+		nuevaDireccion.setNumero("S/N");
+		nuevaDireccion.setEsCobro(true);
+		nuevaDireccion.setCalleSecundaria(objetoCot.getDireccionSiembra());
+		int Contadordirecciones=cotizacion.getAsegurado().getDireccions().size();//a veces no se guardan bien las direcciones se verifica		
+		if (Contadordirecciones==0 )//Si no tiene Direccion //Tomamos la direccion del cliente como la direccion del cultivo, los canales no envian esa informacion
+			nuevaDireccion = direcTransaccion.crear(nuevaDireccion);//creo la direccion		
+		else
+			nuevaDireccion = direcTransaccion.editar(nuevaDireccion);//actualizo la Cotizacion
+		/***FIN DE PROCESO DE DIRECCION DEL CLIENTE***/
 		
@@ -87,75 +120,7 @@
 		
-		if (Contadordirecciones==0 ) {
-			AgriObjetoCotizacionDAO objCotDAO = new AgriObjetoCotizacionDAO();
-			AgriObjetoCotizacion objetoCot = new AgriObjetoCotizacion();
-			// if (!cotizacionId.equals(""))
-			List<CotizacionDetalle> detalle = cotizacion.getCotizacionDetalles();
-			objetoCot = objCotDAO.buscarPorId(new BigInteger(detalle.get(0).getObjetoId()));
-			CantonDAO cantDAO = new CantonDAO();
-			Canton canton = cantDAO.buscarPorId(objetoCot.getCantonId().toString());
-			CiudadDAO ciuDAO = new CiudadDAO();
-			Ciudad ciu = ciuDAO.buscarPorNombre(canton.getNombre());
-			if (ciu==null){
-				//ProvinciaDAO provDAO = new ProvinciaDAO();
-				//Provincia prov = provDAO.buscarPorId(canton.getProvincia().getId());
-				ciu = ciuDAO.buscarPorId(canton.getProvincia().getCapitalId());
-			}
-			TipoDireccionDAO tipoDirecDAO = new TipoDireccionDAO();
-			ZonaDAO zonaDAO = new ZonaDAO();
-			// Por defecto Tipo de direccion (cobro)
-			TipoDireccion tipoDirec = tipoDirecDAO.buscarPorId("3");
-			// Por defecto zona rural
-			Zona zona = zonaDAO.buscarPorId("2");
-			DireccionTransaction direcTransaccion = new DireccionTransaction();
-			Direccion nuevaDireccion = new Direccion();
-			nuevaDireccion.setCiudad(ciu);
-			nuevaDireccion.setEntidad(cliente.getEntidad());
-			nuevaDireccion.setTipoDireccion(tipoDirec);
-			nuevaDireccion.setZona(zona);
-			nuevaDireccion.setCallePrincipal(objetoCot.getDireccionSiembra());
-			nuevaDireccion.setNumero("S/N");
-			nuevaDireccion.setEsCobro(true);
-			nuevaDireccion.setCalleSecundaria(objetoCot.getDireccionSiembra());
-			nuevaDireccion = direcTransaccion.crear(nuevaDireccion);
-			// }
-		}
-		else{
-			AgriObjetoCotizacionDAO objCotDAO = new AgriObjetoCotizacionDAO();
-			AgriObjetoCotizacion objetoCot = new AgriObjetoCotizacion();
-			// if (!cotizacionId.equals(""))
-			List<CotizacionDetalle> detalle = cotizacion.getCotizacionDetalles();
-			objetoCot = objCotDAO.buscarPorId(new BigInteger(detalle.get(0).getObjetoId()));
-			CantonDAO cantDAO = new CantonDAO();
-			Canton canton = cantDAO.buscarPorId(objetoCot.getCantonId().toString());
-			CiudadDAO ciuDAO = new CiudadDAO();
-			Ciudad ciu = ciuDAO.buscarPorNombre(canton.getNombre());
-			if (ciu==null){
-				//ProvinciaDAO provDAO = new ProvinciaDAO();
-				//Provincia prov = provDAO.buscarPorId(canton.getProvincia().getId());
-				ciu = ciuDAO.buscarPorId(canton.getProvincia().getCapitalId());
-			}
-			TipoDireccionDAO tipoDirecDAO = new TipoDireccionDAO();
-			ZonaDAO zonaDAO = new ZonaDAO();
-			// Por defecto Tipo de direccion (cobro)
-			TipoDireccion tipoDirec = tipoDirecDAO.buscarPorId("3");
-			// Por defecto zona rural
-			Zona zona = zonaDAO.buscarPorId("2");
-			DireccionTransaction direcTransaccion = new DireccionTransaction();
-			Direccion nuevaDireccion = new Direccion();
-			nuevaDireccion.setCiudad(ciu);
-			nuevaDireccion.setEntidad(cliente.getEntidad());
-			nuevaDireccion.setTipoDireccion(tipoDirec);
-			nuevaDireccion.setZona(zona);
-			nuevaDireccion.setCallePrincipal(objetoCot.getDireccionSiembra());
-			nuevaDireccion.setNumero("S/N");
-			nuevaDireccion.setEsCobro(true);
-			nuevaDireccion.setCalleSecundaria(objetoCot.getDireccionSiembra());
-			nuevaDireccion = direcTransaccion.editar(nuevaDireccion);
-		}
-		
-		//Creo la entidad en ensurance y actualizo el id en la entidad del cotizador
+		/***PROCESO DE CREACION DE LA ENTIDAD EN ENSURANCE***/
 		String resultadoCrearEntidad=crearActualizarEntidad(cotizacion.getAsegurado());
 		if(!resultadoCrearEntidad.equals("")){
 			Entidad entidad=cotizacion.getAsegurado();
 			entidad.setEntEnsurance(resultadoCrearEntidad);
 			EntidadTransaction entidadTrans=new EntidadTransaction();
@@ -157,7 +122,7 @@
 		String resultadoCrearEntidad=crearActualizarEntidad(cotizacion.getAsegurado());
 		if(!resultadoCrearEntidad.equals("")){
 			Entidad entidad=cotizacion.getAsegurado();
 			entidad.setEntEnsurance(resultadoCrearEntidad);
 			EntidadTransaction entidadTrans=new EntidadTransaction();
-			entidadTrans.editar(entidad);
+			entidadTrans.editar(entidad);//Creo la entidad en ensurance y actualizo el id en la entidad del cotizador
 		}
@@ -163,2 +128,3 @@
 		}
+		/**FIN DE CREACION ENSURANCE**/
 		
@@ -164,7 +130,7 @@
 		
-			
-		AgriResultadoEmision nuevoResultado=new AgriResultadoEmision();
+		/****TODO: PROCESO DE EMISION INTEGRACION ENSURANCE***/
+		AgriResultadoEmision nuevoResultado=new AgriResultadoEmision();//Objeto que se llenara de lo que venga de ensurance
 		if(cotizacion.getId()!=null){
 			AgriSucreAuditoria agriSucreAuditoria = new AgriSucreAuditoria();
 			agriSucreAuditoria.setCanal("EMISION");
 			agriSucreAuditoria.setTramite(cotizacion.getNumeroTramite());
@@ -167,11 +133,10 @@
 		if(cotizacion.getId()!=null){
 			AgriSucreAuditoria agriSucreAuditoria = new AgriSucreAuditoria();
 			agriSucreAuditoria.setCanal("EMISION");
 			agriSucreAuditoria.setTramite(cotizacion.getNumeroTramite());
-			Date fechaActual = new Date();
 			agriSucreAuditoria.setFecha(fechaActual);
 			agriSucreAuditoria.setEstado("Correcto");
 			//Ensamblo el xml para el envió a generrar la póliza
 			nuevoResultado=generarXML(cotizacion);
 			if(nuevoResultado.isGeneradoXMLCorrectamente())
 			{
@@ -172,10 +137,7 @@
 			agriSucreAuditoria.setFecha(fechaActual);
 			agriSucreAuditoria.setEstado("Correcto");
 			//Ensamblo el xml para el envió a generrar la póliza
 			nuevoResultado=generarXML(cotizacion);
 			if(nuevoResultado.isGeneradoXMLCorrectamente())
 			{
-				
-				
-				
 				try{
@@ -181,4 +143,4 @@
 				try{
-										
+					/***LLAMADA AL WS DE EMISION***/
 					WSEmisionAgricolaProxy emisionAgricola=new WSEmisionAgricolaProxy();
 					String resultado=emisionAgricola.emisionPoliza(nuevoResultado.getXmlEmision(), "f2rtiUdv2kjOgaCx");
@@ -183,5 +145,4 @@
 					WSEmisionAgricolaProxy emisionAgricola=new WSEmisionAgricolaProxy();
 					String resultado=emisionAgricola.emisionPoliza(nuevoResultado.getXmlEmision(), "f2rtiUdv2kjOgaCx");
-					
 					agriSucreAuditoria.setObjeto(resultado);
 					AgriSucreAuditoriaTransaction agriSucreAuditoriaTransaction= new AgriSucreAuditoriaTransaction();
@@ -186,5 +147,4 @@
 					agriSucreAuditoria.setObjeto(resultado);
 					AgriSucreAuditoriaTransaction agriSucreAuditoriaTransaction= new AgriSucreAuditoriaTransaction();
-					agriSucreAuditoriaTransaction.crear(agriSucreAuditoria);
-					
+					agriSucreAuditoriaTransaction.crear(agriSucreAuditoria);//AUDITORIA INTERNA
 					if(!resultado.equals("")){
@@ -190,6 +150,5 @@
 					if(!resultado.equals("")){
-						if (!resultado.contains("ERROR")&& !resultado.contains("Exception") ){
-							
+						if (!resultado.contains("ERROR")&& !resultado.contains("Exception") ){							
 							try{
 								CotizacionTransaction cotizacionTransaction = new CotizacionTransaction();
 								//formato esperado 11014757286001|001-003-003708513::2016-07-28 16:33:52.0
@@ -193,7 +152,6 @@
 							try{
 								CotizacionTransaction cotizacionTransaction = new CotizacionTransaction();
 								//formato esperado 11014757286001|001-003-003708513::2016-07-28 16:33:52.0
-	
 								String[] ids=resultado.split(" ");//separamos las fechas
 								if(ids.length!=0){
 									String[] ids2=ids[0].split("::");
@@ -202,9 +160,8 @@
 										CotizacionRespuesta cotizacionRes = new CotizacionRespuesta();
 										CotizacionRespuestaTransaction cotiResTransaction = new CotizacionRespuestaTransaction();
 										EstadoDAO estadoDAO = new EstadoDAO();
-										
 										//si ensurance me devuelve el caracter ya esta emitida
 										//formato correcto
 										//11009488060525|001-003-003698285::2016-07-21 09:43:02.0
 										//formato de ya emitida
 										//1 |001-003-003698285::2016-07-21 09:43:02.0
@@ -206,8 +163,7 @@
 										//si ensurance me devuelve el caracter ya esta emitida
 										//formato correcto
 										//11009488060525|001-003-003698285::2016-07-21 09:43:02.0
 										//formato de ya emitida
 										//1 |001-003-003698285::2016-07-21 09:43:02.0
-	
 										if(factura[0].trim().equals("EXISTE"))
 											throw new Exception("EXISTE Poliza  emitida Anteriormente");
@@ -212,7 +168,6 @@
 										if(factura[0].trim().equals("EXISTE"))
 											throw new Exception("EXISTE Poliza  emitida Anteriormente");
-										
 										Estado estado = estadoDAO.buscarPorNombre("Emitido", "Cotizacion");
 										if (!cotizacion.getEstado().getNombre().equals(estado.getId())){
 											System.out.println("factura[0] :"+factura[0].trim()+ " factura[1] :"+factura[1].trim());
 											cotizacion.setNumeroFactura(factura[1].trim());
@@ -215,6 +170,5 @@
 										Estado estado = estadoDAO.buscarPorNombre("Emitido", "Cotizacion");
 										if (!cotizacion.getEstado().getNombre().equals(estado.getId())){
 											System.out.println("factura[0] :"+factura[0].trim()+ " factura[1] :"+factura[1].trim());
 											cotizacion.setNumeroFactura(factura[1].trim());
-											nuevoResultado.setFactura(factura[1].trim());
 											cotizacion.setEstado(estado);
@@ -220,5 +174,4 @@
 											cotizacion.setEstado(estado);
-											///TODO:tualiza estado tabla cotizacion
-											cotizacion = cotizacionTransaction.editar(cotizacion);
+											cotizacion = cotizacionTransaction.editar(cotizacion);///TODO:tualiza estado tabla cotizacion
 											
 											//guardamos los otros datos de la factura
@@ -223,6 +176,3 @@
 											
 											//guardamos los otros datos de la factura
-											CotizacionDetalleDAO cotizacionDetalleDAO = new CotizacionDetalleDAO();
-											CotizacionDetalle cotizacionDetalle= new CotizacionDetalle();
-											
 											cotizacionDetalle=cotizacionDetalleDAO.buscarCotizacionDetallePorCotizacion(cotizacion).get(0);
@@ -228,4 +178,2 @@
 											cotizacionDetalle=cotizacionDetalleDAO.buscarCotizacionDetallePorCotizacion(cotizacion).get(0);
-											
-											AgriObjetoCotizacionDAO agriObjetoCotizacionDAO= new AgriObjetoCotizacionDAO();
 											AgriObjetoCotizacion agriObjetoCotizacion = agriObjetoCotizacionDAO.buscarPorId(new BigInteger(cotizacionDetalle.getObjetoId()));
@@ -231,5 +179,4 @@
 											AgriObjetoCotizacion agriObjetoCotizacion = agriObjetoCotizacionDAO.buscarPorId(new BigInteger(cotizacionDetalle.getObjetoId()));
-											
 											agriObjetoCotizacion.setPolizaNumero("ID:"+factura[0].trim()+ " factura N.-:"+factura[1].trim());
 											try{
 												String fechaEnsurance=ids2[1].trim();
@@ -238,7 +185,6 @@
 												agriObjetoCotizacion.setPolizaFechaVencimiento(date);
 											}catch(Exception e){
 												System.out.println("no se pudo guardar la fecha de ensurance");
-											}
-											
+											}											
 											AgriObjetoCotizacionTransaction agriObjetoCotizacionTransaction = new AgriObjetoCotizacionTransaction();
 											agriObjetoCotizacionTransaction.editar(agriObjetoCotizacion);
@@ -243,7 +189,6 @@
 											AgriObjetoCotizacionTransaction agriObjetoCotizacionTransaction = new AgriObjetoCotizacionTransaction();
 											agriObjetoCotizacionTransaction.editar(agriObjetoCotizacion);
-											
-											
+																						
 											/**PROCESO DE CREACION DEL DETALLE DE LA COTIZACION ENDOSO***/
 											AgriCotizacionDetalleProcesos agriCotizacionDetalleProcesos = new AgriCotizacionDetalleProcesos();
 											agriCotizacionDetalleProcesos.creardetalleCotizacion(cotizacion, "Emision");
@@ -255,6 +200,7 @@
 											cotizacionRes.setFacturaNumero(cotizacion.getNumeroFactura());
 											cotizacionRes.setFechaEmision(ids2[1].trim());
 											cotizacionRes = cotiResTransaction.crear(cotizacionRes);
+											nuevoResultado.setFactura(factura[1].trim());											
 											nuevoResultado.setEmitidoCorrectamente(true);
 											return nuevoResultado;
 										}
@@ -272,7 +218,7 @@
 								return nuevoResultado;
 							}
 						}
-						else {
+						else {//SI HAY UN MENSAJE DE ENSURANCE
 							if (resultado.contains("EXISTE")){
 								nuevoResultado.setEmitidoCorrectamente(false);
 								nuevoResultado.setMensaje("Cotizacion Emitida Anteriormente");
@@ -285,7 +231,6 @@
 							}
 						}
 					}
-					else{
-						
+					else{//SI ENSURANCE NO DEVUELVE NADA						
 							nuevoResultado.setEmitidoCorrectamente(false);
 							nuevoResultado.setMensaje("Error en el proceso de emisión de Ensurance");
@@ -290,7 +235,5 @@
 							nuevoResultado.setEmitidoCorrectamente(false);
 							nuevoResultado.setMensaje("Error en el proceso de emisión de Ensurance");
-							return nuevoResultado;
-						
-					}
-						
+							return nuevoResultado;						
+					}						
 				}
@@ -296,6 +239,5 @@
 				}
-				catch(Exception ex){
-					
+				catch(Exception ex){//SI HAY UN ERROR GENERAL					
 					if(ex.getMessage().contains("EXISTE")){
 						nuevoResultado.setEmitidoCorrectamente(false);
 						nuevoResultado.setMensaje("Cotizacion Emitida Anteriormente");
@@ -322,6 +264,12 @@
 	}
 
 	private static String crearActualizarEntidad(Entidad entidad) throws Exception{
-		String variableControl="";
+		//Objetos
+		AgriSucreAuditoriaTransaction procesoAuditoria= new AgriSucreAuditoriaTransaction();
+		EntidadWSONBASE entidadEnsurance=new EntidadWSONBASE();
+		Date fecha=new Date();
+		VariableSistemaDAO vsDAO=new VariableSistemaDAO();
+		
+		String variableControl="";//variable de auditoria
 		String ciudad="";
 		String direccion="";
@@ -326,11 +274,9 @@
 		String ciudad="";
 		String direccion="";
-		String provincia="";
-		
-		AgriSucreAuditoria auditoria = new AgriSucreAuditoria();
-		
+		String provincia="";		
+		AgriSucreAuditoria auditoria = new AgriSucreAuditoria();		
 		auditoria.setTramite(""+entidad.getIdentificacion());
 		java.util.Date date2= new java.util.Date();
 		java.sql.Timestamp sq2 = new java.sql.Timestamp(date2.getTime());
 		auditoria.setFecha(sq2);
 		auditoria.setCanal("EMISION");
@@ -332,14 +278,11 @@
 		auditoria.setTramite(""+entidad.getIdentificacion());
 		java.util.Date date2= new java.util.Date();
 		java.sql.Timestamp sq2 = new java.sql.Timestamp(date2.getTime());
 		auditoria.setFecha(sq2);
 		auditoria.setCanal("EMISION");
-		AgriSucreAuditoriaTransaction procesoAuditoria= new AgriSucreAuditoriaTransaction();
-		
-		
 		if(entidad.getDireccions().size()!=0){
 			if (entidad.getDireccions().get(0).getCiudad()!=null){
 				ciudad=entidad.getDireccions().get(0).getCiudad().getId();
 				provincia=entidad.getDireccions().get(0).getCiudad().getProvincia().getId();
 				direccion= entidad.getDireccions().get(0).getCiudad().getProvincia().getNombre()+"/"+ entidad.getDireccions().get(0).getCiudad().getNombre();
 			}
@@ -340,13 +283,11 @@
 		if(entidad.getDireccions().size()!=0){
 			if (entidad.getDireccions().get(0).getCiudad()!=null){
 				ciudad=entidad.getDireccions().get(0).getCiudad().getId();
 				provincia=entidad.getDireccions().get(0).getCiudad().getProvincia().getId();
 				direccion= entidad.getDireccions().get(0).getCiudad().getProvincia().getNombre()+"/"+ entidad.getDireccions().get(0).getCiudad().getNombre();
 			}
-		}
-		
-		if(direccion.trim().equals("")){
+		}else{//si no tiene direccion se envia como si fuese creada en Matriz
 			direccion="Pichincha/Quito";
 			provincia="17";
 			ciudad="1201001";
 		}
@@ -349,7 +290,6 @@
 			direccion="Pichincha/Quito";
 			provincia="17";
 			ciudad="1201001";
 		}
-
-		Date fecha=new Date();
+		/***Servicio web de creacion de usuario en Ensurance***/
 		com.qbe.ensurance.services.WSActualizarCrearEntidadesONBASE.WSActualizarCrearEntidadesONBASEProxy wsEntidadEnsurance=new WSActualizarCrearEntidadesONBASEProxy();
@@ -355,3 +295,2 @@
 		com.qbe.ensurance.services.WSActualizarCrearEntidadesONBASE.WSActualizarCrearEntidadesONBASEProxy wsEntidadEnsurance=new WSActualizarCrearEntidadesONBASEProxy();
-		EntidadWSONBASE entidadEnsurance=new EntidadWSONBASE();
 		try{
@@ -357,49 +296,33 @@
 		try{
-		if(entidad.getApellidos()==null){
-			entidadEnsurance.setApellido(" ");
-			variableControl=variableControl+"Apellido: ";
-		}else{
-			entidadEnsurance.setApellido(entidad.getApellidos());
-			variableControl=variableControl+"Apellido: "+entidad.getApellidos();
-		}
-		entidadEnsurance.setActividadEconomica("-1");
-		variableControl=variableControl+" setActividadEconomica: -1 ";
-		entidadEnsurance.setApellidoRepresentanteLegal(entidad.getApellidos());
-		variableControl=variableControl+" setApellidoRepresentanteLegal: "+entidad.getApellidos();
-		entidadEnsurance.setCiudad(ciudad);
-		variableControl=variableControl+" setCiudad: "+ciudad;
-		entidadEnsurance.setConoceTuCliente("");
-		variableControl=variableControl+" setConoceTuCliente: ";
-		try{
-			entidadEnsurance.setEmailPrincipal(entidad.getMail());
-			variableControl=variableControl+" setEmailPrincipal: "+entidad.getMail();
-		}catch(Exception e){
-			System.out.println("No se encontro el correo electronico");
-			variableControl=variableControl+" setEmailPrincipal: "+"No se encontro el correo electronico";
-		}
-		entidadEnsurance.setEntidadId("no");
-		variableControl=variableControl+" setEntidadId: ";
-		entidadEnsurance.setEstadoCivilId("29");
-		variableControl=variableControl+" setEstadoCivilId: 29";
-		entidadEnsurance.setFechaActualiza(fecha.toLocaleString());
-		variableControl=variableControl+" setFechaActualiza: "+fecha.toLocaleString();
-		entidadEnsurance.setFechaConstitucion(null);
-		variableControl=variableControl+" setFechaConstitucion: null";
-		entidadEnsurance.setFechaNacimiento("01/01/1990");
-		variableControl=variableControl+" setFechaNacimiento: 01/01/1990";
-		entidadEnsurance.setGenero("M");
-		variableControl=variableControl+" setGenero: M";
-		entidadEnsurance.setIdentificacion(entidad.getIdentificacion().trim());
-		variableControl=variableControl+" setIdentificacion: "+entidad.getIdentificacion().trim();
-		entidadEnsurance.setNombre(entidad.getNombres());
-		variableControl=variableControl+" setNombre: "+entidad.getNombres();
-		entidadEnsurance.setNombrecompleto(entidad.getNombreCompleto());
-		variableControl=variableControl+" setNombrecompleto: "+entidad.getNombreCompleto();
-		entidadEnsurance.setNombreDireccion(direccion.trim());
-		variableControl=variableControl+" setNombreDireccion: "+direccion.trim();
-		entidadEnsurance.setNombreRepresentanteLegal(entidad.getNombres());
-		variableControl=variableControl+" setNombreRepresentanteLegal: "+entidad.getNombres();
-		entidadEnsurance.setPais("6815744");
-		variableControl=variableControl+" setPais: 6815744 ";
-		try{
+			//Armado de Objeto Envio Ensurance y log de nuestro Envio
+			if(entidad.getApellidos()==null){
+				entidadEnsurance.setApellido(" ");
+				variableControl=variableControl+"Apellido: ";
+			}else{
+				entidadEnsurance.setApellido(entidad.getApellidos());
+				variableControl=variableControl+"Apellido: "+entidad.getApellidos();
+			}
+			try{
+				entidadEnsurance.setEmailPrincipal(entidad.getMail());
+				variableControl=variableControl+" setEmailPrincipal: "+entidad.getMail();
+			}catch(Exception e){
+				System.out.println("No se encontro el correo electronico");
+				variableControl=variableControl+" setEmailPrincipal: "+"No se encontro el correo electronico";
+			}
+			entidadEnsurance.setActividadEconomica("-1");
+			entidadEnsurance.setApellidoRepresentanteLegal(entidad.getApellidos());
+			entidadEnsurance.setCiudad(ciudad);
+			entidadEnsurance.setConoceTuCliente("");
+			entidadEnsurance.setEntidadId("no");
+			entidadEnsurance.setEstadoCivilId("29");//quemado ya que no tenemos esa informacion desde los clientes
+			entidadEnsurance.setFechaActualiza(fecha.toLocaleString());
+			entidadEnsurance.setFechaConstitucion(null);
+			entidadEnsurance.setFechaNacimiento("01/01/1990");//mandamos porque no tenemos la fecha desde los clientes
+			entidadEnsurance.setGenero("M");
+			entidadEnsurance.setIdentificacion(entidad.getIdentificacion().trim());
+			entidadEnsurance.setNombre(entidad.getNombres());
+			entidadEnsurance.setNombrecompleto(entidad.getNombreCompleto());
+			entidadEnsurance.setNombreDireccion(direccion.trim());
+			entidadEnsurance.setNombreRepresentanteLegal(entidad.getNombres());
+			entidadEnsurance.setPais("6815744");
 			entidadEnsurance.setProvincia(provincia);
@@ -405,2 +328,26 @@
 			entidadEnsurance.setProvincia(provincia);
+			entidadEnsurance.setTelefonoCelular1(entidad.getCelular());
+			entidadEnsurance.setTelefonoConvencional(entidad.getTelefono());
+			entidadEnsurance.setTelefonoOtro(null);
+			entidadEnsurance.setTipoEmpleado("INDEPENDIENTE");
+			entidadEnsurance.setTitulo("");
+			entidadEnsurance.setTipoCliente("PERSONA NATURAL");
+			entidadEnsurance.setPuerto("8084");
+			
+			variableControl=variableControl+" setActividadEconomica: -1 ";		
+			variableControl=variableControl+" setApellidoRepresentanteLegal: "+entidad.getApellidos();		
+			variableControl=variableControl+" setCiudad: "+ciudad;		
+			variableControl=variableControl+" setConoceTuCliente: ";	
+			variableControl=variableControl+" setEntidadId: ";		
+			variableControl=variableControl+" setEstadoCivilId: 29";		
+			variableControl=variableControl+" setFechaActualiza: "+fecha.toLocaleString();		
+			variableControl=variableControl+" setFechaConstitucion: null";		
+			variableControl=variableControl+" setFechaNacimiento: 01/01/1990";		
+			variableControl=variableControl+" setGenero: M";		
+			variableControl=variableControl+" setIdentificacion: "+entidad.getIdentificacion().trim();		
+			variableControl=variableControl+" setNombre: "+entidad.getNombres();
+			variableControl=variableControl+" setNombrecompleto: "+entidad.getNombreCompleto();		
+			variableControl=variableControl+" setNombreDireccion: "+direccion.trim();
+			variableControl=variableControl+" setNombreRepresentanteLegal: "+entidad.getNombres();		
+			variableControl=variableControl+" setPais: 6815744 ";
 			variableControl=variableControl+" setProvincia: "+provincia;
@@ -406,5 +353,9 @@
 			variableControl=variableControl+" setProvincia: "+provincia;
-		}catch(Exception e){
-			System.out.println("No se encontro la provincia");
-		}
+			variableControl=variableControl+" setTelefonoCelular1: "+entidad.getCelular();		
+			variableControl=variableControl+" setTelefonoConvencional: "+entidad.getTelefono();		
+			variableControl=variableControl+" setTelefonoOtro: null";		
+			variableControl=variableControl+" setTipoEmpleado: INDEPENDIENTE ";		
+			variableControl=variableControl+" setTitulo: ";		
+			variableControl=variableControl+" setTipoCliente: PERSONA NATURAL ";		
+			variableControl=variableControl+" setPuerto: 8084 ";
 		
@@ -410,16 +361,9 @@
 		
-		entidadEnsurance.setTelefonoCelular1(entidad.getCelular());
-		variableControl=variableControl+" setTelefonoCelular1: "+entidad.getCelular();
-		entidadEnsurance.setTelefonoConvencional(entidad.getTelefono());
-		variableControl=variableControl+" setTelefonoConvencional: "+entidad.getTelefono();
-		entidadEnsurance.setTelefonoOtro(null);
-		variableControl=variableControl+" setTelefonoOtro: null";
-		entidadEnsurance.setTipoEmpleado("INDEPENDIENTE");
-		variableControl=variableControl+" setTipoEmpleado: INDEPENDIENTE ";
-		entidadEnsurance.setTitulo("");
-		variableControl=variableControl+" setTitulo: ";
-		entidadEnsurance.setTipoCliente("PERSONA NATURAL");
-		variableControl=variableControl+" setTipoCliente: PERSONA NATURAL ";
-		entidadEnsurance.setPuerto("8084");
-		variableControl=variableControl+" setPuerto: 8084 ";
+			//tomamos los valores desde variables del sistema VARIABLES MIXTAS
+			VariableSistema  vs=vsDAO.buscarPorNombre("USUARIO_EMI_AGRICOLA");
+			entidadEnsurance.setUsuario(vs.getValor());   
+			variableControl=variableControl+" setUsuario:" +vs.getValor();
+			vs=vsDAO.buscarPorNombre("CONTRASENIA_EMI_AGRICOLA");
+			entidadEnsurance.setPassword(vs.getValor());
+			variableControl=variableControl+" setPassword: "+vs.getValor();
 		
@@ -425,21 +369,10 @@
 		
-		//tomamos los valores desde variables del sistema
-		
-		VariableSistemaDAO vsDAO=new VariableSistemaDAO();
-	    VariableSistema  vs=vsDAO.buscarPorNombre("USUARIO_EMI_AGRICOLA");
-	    entidadEnsurance.setUsuario(vs.getValor());	    
-		variableControl=variableControl+" setUsuario:" +vs.getValor();
-		
-		vs=vsDAO.buscarPorNombre("CONTRASENIA_EMI_AGRICOLA");
-		entidadEnsurance.setPassword(vs.getValor());
-		variableControl=variableControl+" setPassword: "+vs.getValor();
-		
-		auditoria.setEstado("OK");
-		variableControl=variableControl+" ||||| OBJETO ";
-		auditoria.setObjeto(variableControl);
-		procesoAuditoria.crear(auditoria);
-		
+			//creamos Auditoria de la informacion que enviamos
+			auditoria.setEstado("OK");
+			variableControl=variableControl+" ||||| OBJETO ";
+			auditoria.setObjeto(variableControl);
+			procesoAuditoria.crear(auditoria);		
 		}catch(Exception ex){
 			ex.printStackTrace();
 			throw new Exception("Uno de los parametros del cliente no es correcto "+ex.getMessage());
 		}
@@ -442,7 +375,9 @@
 		}catch(Exception ex){
 			ex.printStackTrace();
 			throw new Exception("Uno de los parametros del cliente no es correcto "+ex.getMessage());
 		}
+		
+		/***COMUNICACION CON EL WS DE ENSURANCE***/
 		String result="";
 		try
 		{
@@ -459,5 +394,5 @@
 			variableControl=variableControl+" ||||| RESPUESTA ENSURANCE: result "+result;
 			auditoria.setObjeto(variableControl);
 			procesoAuditoria.crear(auditoria);
-			throw new Exception("Error al crear la entidad ensurance");
+			throw new Exception("Error al crear la entidad ensurance :"+ex);
 			
@@ -463,7 +398,6 @@
 			
-		}
-		
+		}		
 		return result;
 	}
 	
 	private static AgriResultadoEmision generarXML(Cotizacion cotizacion){
@@ -466,6 +400,7 @@
 		return result;
 	}
 	
 	private static AgriResultadoEmision generarXML(Cotizacion cotizacion){
+		//ARMAMOS LOS OBJETOS
 		AgriResultadoEmision resultado=new AgriResultadoEmision();
 		AgriSucreAuditoria agriSucreAuditoria = new AgriSucreAuditoria();
@@ -470,12 +405,5 @@
 		AgriResultadoEmision resultado=new AgriResultadoEmision();
 		AgriSucreAuditoria agriSucreAuditoria = new AgriSucreAuditoria();
-		try{
-		if(cotizacion.getAsegurado()==null)
-		{
-			resultado.setGeneradoXMLCorrectamente(false);
-			resultado.setMensaje("La cotización no tiene un asegurado");
-			return resultado;
-		}
 		ClienteDAO clienteDAO=new ClienteDAO();
 		AgenteDAO agenteDAO=new AgenteDAO();
 		AgriParametroXPuntoVentaDAO parametroDAO=new AgriParametroXPuntoVentaDAO();
@@ -485,9 +413,4 @@
 		AgriTipoCultivoDAO tipoCultivoDAO=new AgriTipoCultivoDAO();
 		EntidadDAO entidadDAO=new EntidadDAO();
 		EndosoBeneficiarioDAO endosoBeneficiarioDAO=new EndosoBeneficiarioDAO();
-
-		Agente agente=agenteDAO.buscarPorId(cotizacion.getAgenteId().toString());
-		AgriParametroXPuntoVenta parametroXPV=parametroDAO.buscarPorPuntoVentaId(new BigInteger(cotizacion.getPuntoVenta().getId()));
-		PuntoVenta puntoVenta=puntoVentaDAO.buscarPorId(cotizacion.getPuntoVenta().getId());
-		ProductoXPuntoVenta productoXPV=productoXPVDAO.buscarPorId(cotizacion.getProductoXPuntoVentaId().toString());
 		CotizacionDetalle cotizacionDetalle = new CotizacionDetalle();
@@ -493,10 +416,3 @@
 		CotizacionDetalle cotizacionDetalle = new CotizacionDetalle();
-		CotizacionDetalleDAO cotizacionDetalleDAO= new CotizacionDetalleDAO();
-		cotizacionDetalle=cotizacionDetalleDAO.buscarCotizacionDetallePorCotizacion(cotizacion).get(0);
-		AgriObjetoCotizacion objetoCotizacion=objetoCotizacionDAO.buscarPorId(new BigInteger(cotizacionDetalle.getObjetoId()));
-		AgriTipoCultivo tipoCultivo=tipoCultivoDAO.BuscarPorId(objetoCotizacion.getTipoCultivoId());
-		Cliente cliente=clienteDAO.buscarPorId(cotizacion.getClienteId().toString());
-		
-		String zonaAfectada="0";
 		Provincia  provincia = new Provincia();
 		ProvinciaDAO provinciaDAO= new ProvinciaDAO();
@@ -501,19 +417,15 @@
 		Provincia  provincia = new Provincia();
 		ProvinciaDAO provinciaDAO= new ProvinciaDAO();
-		provincia= provinciaDAO.buscarPorId(objetoCotizacion.getProvinciaId().toString());
-		if(provincia.getNombre().trim().equals("MANABI")||provincia.getNombre().trim().equals("ESMERALDAS")){
-			int canal=Integer.parseInt(parametroXPV.getCanalId().toString());
-			if(canal==1)
-				zonaAfectada="0";
-			else
-				zonaAfectada="1";	
-		}
-		//Valido que existe un tipo de cultivo
-		if(tipoCultivo.getTipoCultivoId()==null){
-			resultado.setGeneradoXMLCorrectamente(false);
-			resultado.setMensaje("No existe el tipo de cultivo indicado en la cotización");
-			return resultado;
-		}
-		else{
-			if(tipoCultivo.getCodEnsurance().equals("") || tipoCultivo.getCodEnsurance()==null){
+		AgriCanalDAO agriCanalDAO=new AgriCanalDAO();
+		AgriParametroXCanalDAO apcDAO=new AgriParametroXCanalDAO();
+		AgriAuditoriaCotizacion  agriAuditoriaCotizacion = new AgriAuditoriaCotizacion();
+	    AgriAuditoriaCotizacionDAO agriAuditoriaCotizacionDAO = new AgriAuditoriaCotizacionDAO();
+	    CotizacionTransaction  cotizacionTransaction = new CotizacionTransaction();
+	    TipoVariableDAO tipoVariableDao = new TipoVariableDAO();
+	    VariableSistemaDAO variableDAO= new VariableSistemaDAO();
+		
+		//COMENSAMOS A ARMAR EL XML :)
+		try{
+			if(cotizacion.getAsegurado()==null)
+			{
 				resultado.setGeneradoXMLCorrectamente(false);
@@ -519,4 +431,4 @@
 				resultado.setGeneradoXMLCorrectamente(false);
-				resultado.setMensaje("El tipo de cultivo no tiene un código válido en Ensurance");
+				resultado.setMensaje("La cotización no tiene un asegurado");
 				return resultado;
 			}
@@ -521,4 +433,12 @@
 				return resultado;
 			}
-		}
+			Agente agente=agenteDAO.buscarPorId(cotizacion.getAgenteId().toString());
+			AgriParametroXPuntoVenta parametroXPV=parametroDAO.buscarPorPuntoVentaId(new BigInteger(cotizacion.getPuntoVenta().getId()));
+			PuntoVenta puntoVenta=puntoVentaDAO.buscarPorId(cotizacion.getPuntoVenta().getId());
+			ProductoXPuntoVenta productoXPV=productoXPVDAO.buscarPorId(cotizacion.getProductoXPuntoVentaId().toString());
+			CotizacionDetalleDAO cotizacionDetalleDAO= new CotizacionDetalleDAO();
+			cotizacionDetalle=cotizacionDetalleDAO.buscarCotizacionDetallePorCotizacion(cotizacion).get(0);
+			AgriObjetoCotizacion objetoCotizacion=objetoCotizacionDAO.buscarPorId(new BigInteger(cotizacionDetalle.getObjetoId()));
+			AgriTipoCultivo tipoCultivo=tipoCultivoDAO.BuscarPorId(objetoCotizacion.getTipoCultivoId());
+			Cliente cliente=clienteDAO.buscarPorId(cotizacion.getClienteId().toString());
 		
@@ -524,30 +444,43 @@
 		
-		//Determino la plantilla
-		String plantillaId="";
-		String contenedorId="";
-		String sucursalId="";
-		if(parametroXPV.getCanalId()!=null)
-		{
-			AgriCanalDAO agriCanalDAO=new AgriCanalDAO();
-			AgriCanal agriCanal=agriCanalDAO.BuscarPorId(parametroXPV.getCanalId());
-//			if(agriCanal.getNombre().equals("DIRECTOS")){
-//				//contenedorId="";
-//				//TODO: En la ultima reunion se quedo que en directos si iba a tener un contenedor
-//				contenedorId=parametroXPV.getContenedorEnsuranceId();
-//			}
-//			else{
-//				contenedorId=parametroXPV.getContenedorEnsuranceId();
-//			}
-				
-			
-			AgriParametroXCanalDAO apcDAO=new AgriParametroXCanalDAO();
-			
-			AgriParametroXCanal parametroXCanal = apcDAO.obtenerPorCanalTipoCultivo(parametroXPV.getPuntoVentaId(), tipoCultivo.getTipoCultivoId());
-			if(parametroXCanal.getParametroCanalId()!=null){
-				if(parametroXCanal.getPlantillaId()!=null){
-					plantillaId=parametroXCanal.getPlantillaId();
-					contenedorId=parametroXCanal.getContenedorEnsuranceId();
-					
+			/*TODO: VERIFICAMOS SI SE ENCUENTRA EN ZONA DE TERREMOTO*/
+			String zonaAfectada="0";
+			provincia= provinciaDAO.buscarPorId(objetoCotizacion.getProvinciaId().toString());
+			if(provincia.getNombre().trim().equals("MANABI")||provincia.getNombre().trim().equals("ESMERALDAS")){
+				int canal=Integer.parseInt(parametroXPV.getCanalId().toString());
+				if(canal==1)
+					zonaAfectada="0";
+				else
+					zonaAfectada="1";	
+			}
+			//Valido que existe un tipo de cultivo
+			if(tipoCultivo.getTipoCultivoId()==null){
+				resultado.setGeneradoXMLCorrectamente(false);
+				resultado.setMensaje("No existe el tipo de cultivo indicado en la cotización");
+				return resultado;
+			}
+			else{
+				if(tipoCultivo.getCodEnsurance().equals("") || tipoCultivo.getCodEnsurance()==null){
+					resultado.setGeneradoXMLCorrectamente(false);
+					resultado.setMensaje("El tipo de cultivo no tiene un código válido en Ensurance");
+					return resultado;
+				}
+			}
+			//TODO: VERIFICAMOS LA CONFIGURACION DE LA PLANTILLA Y EL CONTENEDOR
+			//Determino la plantilla del tipo de cultivo para la emision, Agricola cada canal y cultivo tienen ids diferentes
+			String plantillaId="";
+			String contenedorId="";
+			if(parametroXPV.getCanalId()!=null){
+				AgriParametroXCanal parametroXCanal = apcDAO.obtenerPorCanalTipoCultivo(parametroXPV.getPuntoVentaId(), tipoCultivo.getTipoCultivoId());
+				if(parametroXCanal.getParametroCanalId()!=null){
+					if(parametroXCanal.getPlantillaId()!=null){
+						plantillaId=parametroXCanal.getPlantillaId();
+						contenedorId=parametroXCanal.getContenedorEnsuranceId();						
+					}
+					else{
+						resultado.setGeneradoXMLCorrectamente(false);
+						resultado.setMensaje("No existe configurado una plantilla para este canal.");
+						return resultado;
+					}						
 				}
 				else{
 					resultado.setGeneradoXMLCorrectamente(false);
@@ -551,7 +484,7 @@
 				}
 				else{
 					resultado.setGeneradoXMLCorrectamente(false);
-					resultado.setMensaje("No existe configurado una plantilla para este canal.");
+					resultado.setMensaje("No existe la configuración de paramateros para este canal.");
 					return resultado;
 				}
 					
@@ -561,16 +494,7 @@
 				resultado.setMensaje("No existe la configuración de paramateros para este canal.");
 				return resultado;
 			}
-				
-		}
-		else{
-			resultado.setGeneradoXMLCorrectamente(false);
-			resultado.setMensaje("No existe la configuración de paramateros para este canal.");
-			return resultado;
-		}
-		
-		
-		EndosoBeneficiario endosoBeneficiario = endosoBeneficiarioDAO.buscarPorCotizacion(cotizacion);
-		
+			//VERIFICAMOS EL ENDOSOBENEFICIARIO		
+			EndosoBeneficiario endosoBeneficiario = endosoBeneficiarioDAO.buscarPorCotizacion(cotizacion);	//si no tiene endoso beneficiario lo creamos	
 			if (endosoBeneficiario == null){
 				endosoBeneficiario = new EndosoBeneficiario();
@@ -575,6 +499,5 @@
 			if (endosoBeneficiario == null){
 				endosoBeneficiario = new EndosoBeneficiario();
-				//TODO:COntrolar que el ensodoso beneficiario se cree solo para banca comunal y credife 
 				EndosoBeneficiarioTransaction endosoBeneficiarioTransaction = new EndosoBeneficiarioTransaction();
 				BeneficiarioDAO beneficiarioDAO = new BeneficiarioDAO();
 				Beneficiario beneficiario = beneficiarioDAO.buscarPorId(parametroXPV.getBeneficiarioId());
@@ -583,4 +506,15 @@
 				endosoBeneficiario.setMonto(cotizacion.getSumaAseguradaTotal());
 				endosoBeneficiario=endosoBeneficiarioTransaction.crear(endosoBeneficiario);
 			}
+			//PROCESO DE ARMADO DE FECHAS	
+			agriAuditoriaCotizacion = agriAuditoriaCotizacionDAO.BuscarPorCotizacinId(new BigInteger(cotizacion.getId()));
+			Calendar c = Calendar.getInstance(); ;
+			c.setTime(objetoCotizacion.getFechaSiembra()); 
+			c.add(Calendar.DATE, tipoCultivo.getVigenciaDias());
+			Date vigenciaHasta = c.getTime();// vigencia hasta para la emision
+			DateFormat df = new SimpleDateFormat("dd/MM/yyyy");		
+			String fechaInicioCultivo = df.format(objetoCotizacion.getFechaSiembra());		
+			String fechaFinalCultivo = df.format(vigenciaHasta);		
+			long fechaInicioPoliza = cotizacion.getVigenciaDesde().getTime()/1000;		
+			long fechaFinalPoliza = vigenciaHasta.getTime()/1000;
 		
@@ -586,62 +520,92 @@
 		
-			
-		//CREACION DE LA DIRECCION
-			
-		//Proceso de Auditoria	
-		
-			
-	    AgriAuditoriaCotizacion  agriAuditoriaCotizacion = new AgriAuditoriaCotizacion();
-	    AgriAuditoriaCotizacionDAO agriAuditoriaCotizacionDAO = new AgriAuditoriaCotizacionDAO();
-	    agriAuditoriaCotizacion = agriAuditoriaCotizacionDAO.BuscarPorCotizacinId(new BigInteger(cotizacion.getId()));
-		Calendar c = Calendar.getInstance(); ;
-		c.setTime(objetoCotizacion.getFechaSiembra()); 
-		c.add(Calendar.DATE, tipoCultivo.getVigenciaDias());
-		Date vigenciaHasta = c.getTime();
-		
-		Calendar cPol = Calendar.getInstance(); 
-		cPol.setTime(agriAuditoriaCotizacion.getFecha()); 
-		cPol.add(Calendar.DATE, tipoCultivo.getVigenciaDias());
-		Date vigenciaPolHasta = cPol.getTime();
-		CotizacionTransaction  cotizacionTransaction = new CotizacionTransaction();
-		
-		cotizacion.setVigenciaDesde(agriAuditoriaCotizacion.getFecha());
-		cotizacionTransaction.editar(cotizacion);
-		
-		
-		DateFormat df = new SimpleDateFormat("dd/MM/yyyy");
-		
-		String fechaInicioCultivo = df.format(objetoCotizacion.getFechaSiembra());
-		
-		String fechaFinalCultivo = df.format(vigenciaHasta);
-		
-		long fechaInicioPoliza = cotizacion.getVigenciaDesde().getTime()/1000;
-		
-		long fechaFinalPoliza = vigenciaPolHasta.getTime()/1000;
-		/*Date fechaAprobacion=new Date();
-		SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");
-		try{
-			fechaAprobacion=dateFormat.parse(fechaInicioVigencia);
-		} catch (ParseException e) {
-			e.printStackTrace();
-			.append("<puerto>8084</puerto>")
-		}*/
-		
-		
-		/*PARA EL ENVIO DE LOS EMAIL*/
-		/*PROCESO DE CALCULO DE COMPONENTES*/
-		TipoVariableDAO tipoVariableDao = new TipoVariableDAO();
-        TipoVariable tipoVariable = tipoVariableDao.buscarPorId("3");
-        VariableSistemaDAO variableDAO= new VariableSistemaDAO();
-        List<VariableSistema> variablesistema = variableDAO.buscarTipoVariable(tipoVariable);
-        String CorreoElectronico="";
-        String variableS="";
-        if(parametroXPV.getCanalId().toString().equals("2")){
-        	variableS="CORREO_PRONACA";
-        }
-        if(parametroXPV.getCanalId().toString().equals("5")){
-        	variableS="CORREO_COPROGRESO";
-        }
-        if(parametroXPV.getCanalId().toString().equals("3")){
-        	variableS="CORREO_PICHINCHA";
-        }
+			/****TODO: CONFIGURACIONES GLOBALES TOMADOS POR MEDIO DE VARIABLES DEL SISTEMA****/
+			/*PROCESO DE CALCULO DE COMPONENTES*/			
+	        TipoVariable tipoVariable = tipoVariableDao.buscarPorId("3");
+	        List<VariableSistema> variablesistema = variableDAO.buscarTipoVariable(tipoVariable);
+	        String CorreoElectronico="";
+	        String variableS="";
+	        String login="";
+	        String password="";
+	        String tipoRiesgo="";
+	        String claseRiesgo="";
+	        String tipoItem="";
+	        switch (parametroXPV.getCanalId().toString()) {
+		         case "2":
+		        	 variableS="CORREO_PRONACA";
+		             break;
+		         case "3":
+		        	 variableS="CORREO_PICHINCHA";
+		             break;
+		         case "5":
+		        	 variableS="CORREO_COPROGRESO";
+		             break;	         
+		         case "6":
+		        	 variableS="CORREO_AGRIPAC";
+		             break;
+		         case "7":
+		        	 variableS="CORREO_ECUAQUIMICA";
+		             break;
+		         default:
+		        	resultado.setGeneradoXMLCorrectamente(false);
+					resultado.setMensaje("No existe la configuración de correos para facturacion electronica.");
+					return resultado;
+	        }
+	        //RECORRO LAS VARIABLES DEL SISTEMA TRAYENDO SOLO LAS QUE NECESITO       
+	        if(variablesistema.size() > 0) {
+	        	for(VariableSistema variable : variablesistema) {	        		
+	        		if(variable.getNombre().equals(variableS))
+	        			CorreoElectronico=variable.getValor();//%COMISION DE AGENTE
+	        		if(variable.getNombre().equals("USUARIO_EMI_AGRICOLA"))
+	        			login=variable.getValor();//usuario con el que se logue para emision
+	        		if(variable.getNombre().equals("CONTRASENIA_EMI_AGRICOLA"))
+	        			password=variable.getValor();//contrasenia con la que se loguea para la emision
+	        		if(variable.getNombre().equals("TIPO_RIESGO_AGRICOLA"))
+	        			tipoRiesgo=variable.getValor();//TIPO_RIESGO_AGRICOLA para la emision
+	        		if(variable.getNombre().equals("CLASE_RIESGO_AGRICOLA"))
+	        			claseRiesgo=variable.getValor();//CLASE_RIESGO_AGRICOLA para la emision
+	        		if(variable.getNombre().equals("TIPO_ITEM_AGRICOLA"))
+	        			tipoItem=variable.getValor();//TIPO_ITEM_AGRICOLA para la emision
+	        	}
+	        }
+	        /**VARIABLES EN PREPARACION DE LA EMISION**/	        
+	        String agricultorTecnificado="";        
+	        if(objetoCotizacion.getAgricultorTecnificado())
+	        	agricultorTecnificado="Si";
+	        else
+	        	agricultorTecnificado="No";
+	        String EndosoBeneficiarioId="";
+	        if(endosoBeneficiario!=null){
+				Entidad entidadBeneficiario=entidadDAO.buscarEntidadPorIdEnsurance(endosoBeneficiario.getBeneficiario().getCodigoEnsurance().toString());
+				EndosoBeneficiarioId=entidadBeneficiario.getEntEnsurance();
+			}else
+				EndosoBeneficiarioId="0";
+	        String cantonSBS="";
+	        String parroquiaSBS="";
+	        if(cliente.getEntidad().getDireccions().get(0).getParroquia()!=null){
+	        	cantonSBS=cliente.getEntidad().getDireccions().get(0).getParroquia().getCanton().getId();
+	        	parroquiaSBS=cliente.getEntidad().getDireccions().get(0).getParroquia().getId();
+			}
+			else{
+				cantonSBS="1201";
+				parroquiaSBS="120153";
+			}
+	         /**CASO ESPECIAL**/
+	        String unidadNegocio="";
+	        if(puntoVenta.getNombre().equals("COOPROGRESO")){
+	        	//TODO: OJO SOLO COOPROGRESO Peticion david garzon para distingir entre masivos y agricola ganadero
+	        	//encontramos el usuario que relizo la cotizacion.
+	        	String nombreEjecutivo=objetoCotizacion.getUsuarioOffline();
+	        	UsuariosOffline usuariosOffline = new UsuariosOffline();
+	    		UsuariosOfflineDAO usuariosOfflineDAO = new UsuariosOfflineDAO();
+	    		usuariosOffline=usuariosOfflineDAO.BuscarNombre(nombreEjecutivo);	    		
+	    		//Tomamos la unidad de negocio
+	    		UnidadNegocioDAO unidadNegocioDAO = new UnidadNegocioDAO();
+	    		UnidadNegocio negocio=unidadNegocioDAO.buscarPorId(usuariosOffline.getUnidadNegocio());
+	    		unidadNegocio=negocio.getUnEnsurance();
+	    		
+	        }else{
+	        	//TODO: Para canales sucre, banca comunal, Pronaca todo se emite como agricola ganadero
+	        	unidadNegocio=productoXPV.getUnidadNegocio().getUnEnsurance();
+	        }
+            /***DESPUES DE TODITO ESO VIENE EL ARMADO DEL XML***/    
         
@@ -647,90 +611,117 @@
         
-        
-        String login="";
-        String password="";
-        String tipoRiesgo="";
-        String claseRiesgo="";
-        String tipoItem="";
-        if(variablesistema.size() > 0) {
-        	for(VariableSistema variable : variablesistema) {
-        		
-        		if(variable.getNombre().equals(variableS)){
-        			CorreoElectronico=variable.getValor();//%COMISION DE AGENTE
-        		}
-        		if(variable.getNombre().equals("USUARIO_EMI_AGRICOLA")){
-        			login=variable.getValor();//usuario con el que se logue para emision
-        		}
-        		if(variable.getNombre().equals("CONTRASENIA_EMI_AGRICOLA")){
-        			password=variable.getValor();//contrasenia con la que se loguea para la emision
-        		}
-        		if(variable.getNombre().equals("TIPO_RIESGO_AGRICOLA")){
-        			tipoRiesgo=variable.getValor();//TIPO_RIESGO_AGRICOLA para la emision
-        		}
-        		if(variable.getNombre().equals("CLASE_RIESGO_AGRICOLA")){
-        			claseRiesgo=variable.getValor();//CLASE_RIESGO_AGRICOLA para la emision
-        		}
-        		if(variable.getNombre().equals("TIPO_ITEM_AGRICOLA")){
-        			tipoItem=variable.getValor();//TIPO_ITEM_AGRICOLA para la emision
-        		}
-        	}
-        }
-        String agricultorTecnificado="";
-        
-        if(objetoCotizacion.getAgricultorTecnificado()){
-        	agricultorTecnificado="Si";
-        }else{
-        	agricultorTecnificado="No";
-        }
-		
-        //Encontramos la unidad de negocio
-        String unidadNegocio="";
-        
-        if(puntoVenta.getNombre().equals("COOPROGRESO")){
-        	//TODO: OJO SOLO COOPROGRESO Peticion david garzon para distingir entre masivos y agricola ganadero
-        	//encontramos el usuario que relizo la cotizacion.
-        	String nombreEjecutivo=objetoCotizacion.getUsuarioOffline();
-        	UsuariosOffline usuariosOffline = new UsuariosOffline();
-    		UsuariosOfflineDAO usuariosOfflineDAO = new UsuariosOfflineDAO();
-    		usuariosOffline=usuariosOfflineDAO.BuscarNombre(nombreEjecutivo);
-    		
-    		//Tomamos la unidad de negocio
-    		UnidadNegocioDAO unidadNegocioDAO = new UnidadNegocioDAO();
-    		UnidadNegocio negocio=unidadNegocioDAO.buscarPorId(usuariosOffline.getUnidadNegocio());
-    		unidadNegocio=negocio.getUnEnsurance();
-    		
-        }else{
-        	//TODO: Para canales sucre, banca comunal, Pronaca todo se emite como agricola ganadero
-        	unidadNegocio=productoXPV.getUnidadNegocio().getUnEnsurance();
-        }
-                
-        
-		StringBuilder xml=new StringBuilder("<superObjetoXML><detallesPoliza><identificador>").append(cotizacion.getId()).append("</identificador>")
-		.append("<login>").append(login).append("</login>")
-		.append("<pass>").append(password).append("</pass>")
-		.append("<agenteId>").append(agente.getAgeEnsurance()).append("</agenteId>")
-		.append("<porcentajeComision>").append(cotizacion.getPorcentajeComision()).append("</porcentajeComision>")
-		.append("<valorprima>").append(cotizacion.getPrimaNetaTotal()).append("</valorprima>")
-		.append("<canalId>").append(parametroXPV.getCanalId()).append("</canalId>")
-		.append("<contenedorId>").append(contenedorId).append("</contenedorId>")
-		//ensurance solo acepta lote de maximo 40 caracteres
-		.append("<loteImpresion>").append((puntoVenta.getNombre())).append("</loteImpresion>")
-		.append("<puntoVentaId>")
-		.append(puntoVenta.getPtoEnsurance())
-		.append("</puntoVentaId>")
-		.append("<tipoRiesgoId>").append(tipoRiesgo).append("</tipoRiesgoId>")
-		.append("<claseRiesgoId>").append(claseRiesgo).append("</claseRiesgoId>")
-		.append("<tipoItemId>").append(tipoItem).append("</tipoItemId>")
-		.append("<monedaId>11141120</monedaId>")
-		.append("<plantillaId>").append(plantillaId).append("</plantillaId>")
-		.append("<firmaDigitalId>1</firmaDigitalId>")
-		.append("<usuarioActualiza>10822106152960</usuarioActualiza>")
-		.append("<ramoId>7274513</ramoId>")
-		.append("<mnemotecnicoRamo>SA</mnemotecnicoRamo>")
-		.append("<unidadNegocioId>").append(unidadNegocio).append("</unidadNegocioId>")
-		.append("<unidadProduccionId>").append(productoXPV.getUnidadProduccion().getUpEnsurance()).append("</unidadProduccionId>")
-		//NUMERO DE COTIZACION 2
-		.append("<numeroPoliza>").append(objetoCotizacion.getIdCotizacion2()).append("</numeroPoliza>")
-		.append("<codigoIntegracion>998000008</codigoIntegracion>")
-		.append("<fechaAprobacion>").append(Utilitarios.actualDate()).append("</fechaAprobacion>");
+	        StringBuilder xml=new StringBuilder("<superObjetoXML>")
+	        		.append("<detallesPoliza>")
+	        			.append("<identificador>").append(cotizacion.getId()).append("</identificador>")
+		        		.append("<login>").append(login).append("</login>")
+		        		.append("<pass>").append(password).append("</pass>")
+		        		.append("<agenteId>").append(agente.getAgeEnsurance()).append("</agenteId>")
+		        		.append("<porcentajeComision>").append(cotizacion.getPorcentajeComision()).append("</porcentajeComision>")
+		        		.append("<valorprima>").append(cotizacion.getPrimaNetaTotal()).append("</valorprima>")
+		        		.append("<canalId>").append(parametroXPV.getCanalId()).append("</canalId>")
+		        		.append("<contenedorId>").append(contenedorId).append("</contenedorId>")
+		        		.append("<loteImpresion>").append((puntoVenta.getNombre())).append("</loteImpresion>")
+		        		.append("<puntoVentaId>").append(puntoVenta.getPtoEnsurance()).append("</puntoVentaId>")
+		        		.append("<tipoRiesgoId>").append(tipoRiesgo).append("</tipoRiesgoId>")
+		        		.append("<claseRiesgoId>").append(claseRiesgo).append("</claseRiesgoId>")
+		        		.append("<tipoItemId>").append(tipoItem).append("</tipoItemId>")
+		        		.append("<monedaId>11141120</monedaId>")
+		        		.append("<plantillaId>").append(plantillaId).append("</plantillaId>")
+		        		.append("<firmaDigitalId>1</firmaDigitalId>")
+		        		.append("<usuarioActualiza>10822106152960</usuarioActualiza>")
+		        		.append("<ramoId>7274513</ramoId>")
+		        		.append("<mnemotecnicoRamo>SA</mnemotecnicoRamo>")
+		        		.append("<unidadNegocioId>").append(unidadNegocio).append("</unidadNegocioId>")//agricola-ganadero o como masivos
+		        		.append("<unidadProduccionId>").append(productoXPV.getUnidadProduccion().getUpEnsurance()).append("</unidadProduccionId>")//agricola
+		        		.append("<numeroPoliza>").append(objetoCotizacion.getIdCotizacion2()).append("</numeroPoliza>")//NUMERO DE COTIZACION 2
+		        		.append("<codigoIntegracion>998000008</codigoIntegracion>")
+		        		.append("<fechaAprobacion>").append(Utilitarios.actualDate()).append("</fechaAprobacion>")
+						.append("<codigoEntidadFinanciera>").append(EndosoBeneficiarioId).append("</codigoEntidadFinanciera>")						
+						.append("<vigenciaDesde>").append(fechaInicioPoliza).append("</vigenciaDesde>")
+						.append("<valorAsegurado>").append(cotizacion.getSumaAseguradaTotal()).append("</valorAsegurado>")
+						.append("<vigenciaHasta>").append(fechaFinalPoliza).append("</vigenciaHasta>")
+						.append("<sucursalId>").append(cotizacion.getPuntoVenta().getSucursal().getSucEnsurance()).append("</sucursalId>")
+						.append("<esZonaAfectada>").append(zonaAfectada).append("</esZonaAfectada>")
+					.append("</detallesPoliza>")
+					.append("<loteCultivo>")
+						.append("<loteCultivoId>-1</loteCultivoId>")
+						.append("<nombre>").append(puntoVenta.getNombre()).append("</nombre>")
+						.append("<valorAsegurado>").append(cotizacion.getSumaAseguradaTotal()).append("</valorAsegurado>")
+						.append("<numeroHectareas>").append(objetoCotizacion.getHectareasLote()).append("</numeroHectareas>")
+						.append("<valorPorHectarea>").append(objetoCotizacion.getCostoProduccion()).append("</valorPorHectarea>")
+						.append("<gpsLoteX>").append(objetoCotizacion.getLatitud()).append("</gpsLoteX>")
+						.append("<gpsLoteY>").append(objetoCotizacion.getLongitud()).append("</gpsLoteY>")
+						.append("<tasa>").append(cotizacion.getTasaProductoValor()).append("</tasa>")
+						.append("<tipoCultivoId>").append(tipoCultivo.getCodEnsurance()).append("</tipoCultivoId>")
+						.append("<diasVigencia>").append(tipoCultivo.getVigenciaDias()).append("</diasVigencia>")
+						.append("<inicioVigenciaCultivo>").append(fechaInicioCultivo).append("</inicioVigenciaCultivo>")
+						.append("<finVigenciaCultivo>").append(fechaFinalCultivo).append("</finVigenciaCultivo>")
+						.append("<variedad>").append(objetoCotizacion.getVariedad()).append("</variedad>")
+						.append("<numeroHectareasAsegurables>").append(objetoCotizacion.getHectareasAsegurables()).append("</numeroHectareasAsegurables>")
+						.append("<esTecnificado>").append(agricultorTecnificado).append("</esTecnificado>")
+						.append("<fechaTentativaSiembra>").append(objetoCotizacion.getFechaSiembra()).append("</fechaTentativaSiembra>")
+						.append("<propiedadId>-1</propiedadId>")
+					.append("</loteCultivo>")
+					.append("<cliente>")
+						.append("<id>no</id>")
+						.append("<entidadId>")
+						.append(cliente.getEntidad().getEntEnsurance()==null||cliente.getEntidad().getEntEnsurance().trim().equals("0")?"no":cliente.getEntidad().getEntEnsurance()).append("</entidadId>")
+						.append("<nombres>").append(cliente.getEntidad().getNombres()).append("</nombres>")
+						.append("<apellidos>").append(cliente.getEntidad().getApellidos()==null?" ":cliente.getEntidad().getApellidos()).append("</apellidos>")
+						.append("<tipoIdentificacion>")
+						.append(cliente.getEntidad().getTipoIdentificacion().getId().equals("1") ? "c":cliente.getEntidad().getTipoIdentificacion().equals("2") ? "p":"r")
+						.append("</tipoIdentificacion>")
+						.append("<tipoEntidadId>").append(cliente.getEntidad().getTipoEntidad().getId()).append("</tipoEntidadId>")
+						.append("<identificacion>").append(cliente.getEntidad().getIdentificacion()).append("</identificacion>")
+	        			.append("<email>").append(CorreoElectronico).append("</email>")		
+	        			.append("<genero>f</genero>")
+	        			.append("<esEmpresa>")
+	        			.append(cliente.getEntidad().getTipoIdentificacion().getId().equals("1") ? "false":cliente.getEntidad().getTipoIdentificacion().getId().equals("2") ? "false":cliente.getEntidad().getTipoIdentificacion().getId().equals("3")?"false":"true")
+	        			.append("</esEmpresa>")
+	        			.append("<DireccionDTO><direccion>")
+		        			.append("<paisId>6815744</paisId>")		
+		        			.append("<provinciaId>").append(cliente.getEntidad().getDireccions().get(0).getCiudad().getProvincia().getCodigoSbs()).append("</provinciaId>")
+		        			.append("<ciudadId>").append(cliente.getEntidad().getDireccions().get(0).getCiudad().getId()).append("</ciudadId>")
+							.append("<cantonId>").append(cantonSBS).append("</cantonId>")
+							.append("<parroquiaId>").append(parroquiaSBS).append("</parroquiaId>")
+							.append("<direccion>")		
+								.append(cliente.getEntidad().getDireccions().get(0).getCallePrincipal())
+								.append(" ")
+								.append(cliente.getEntidad().getDireccions().get(0).getNumero())
+								.append(" ")
+								.append(cliente.getEntidad().getDireccions().get(0).getCalleSecundaria())
+							.append("</direccion>")
+							.append("<telefono>").append((cliente.getEntidad().getTelefono()!=null && !cliente.getEntidad().getTelefono().equals("")) ? cliente.getEntidad().getTelefono():"-").append("</telefono>")
+						.append("</direccion></DireccionDTO>")
+					.append("</cliente>")
+					.append("<asegurado>")
+						.append("<id>no</id>")
+						.append("<entidadId>").append(cotizacion.getAsegurado().getEntEnsurance()).append("</entidadId>")
+						.append("<nombres>").append(cotizacion.getAsegurado().getNombres()).append("</nombres>")
+						.append("<apellidos>").append(cotizacion.getAsegurado().getApellidos()).append("</apellidos>")
+						.append("<tipoIdentificacion>")
+						.append(cotizacion.getAsegurado().getTipoIdentificacion().getId()=="1" ? "c":cliente.getEntidad().getTipoIdentificacion().getId()=="2" ? "p":"r")
+						.append("</tipoIdentificacion>")
+						.append("<tipoEntidadId>").append(cotizacion.getAsegurado().getTipoEntidad().getId()).append("</tipoEntidadId>")
+						.append("<identificacion>").append(cotizacion.getAsegurado().getIdentificacion()).append("</identificacion>")
+						.append("<genero>f</genero>")
+						.append("<esEmpresa>")
+						.append(cotizacion.getAsegurado().getTipoIdentificacion().getId()=="1" ? "false":cotizacion.getAsegurado().getTipoIdentificacion().getId()=="2" ? "false":cotizacion.getAsegurado().getTipoIdentificacion().getId()=="3"?"false":"true")
+						.append("</esEmpresa>")
+						.append("<DireccionDTO><direccion>")
+							.append("<paisId>6815744</paisId>")
+							.append("<provinciaId>").append(cotizacion.getAsegurado().getDireccions().get(0).getCiudad().getProvincia().getCodigoSbs()).append("</provinciaId>")
+							.append("<ciudadId>").append(cotizacion.getAsegurado().getDireccions().get(0).getCiudad().getId()).append("</ciudadId>")
+					        .append("<cantonId>").append(cantonSBS).append("</cantonId>")
+							.append("<parroquiaId>").append(parroquiaSBS).append("</parroquiaId>")
+							.append("<direccion>")
+							.append(cotizacion.getAsegurado().getDireccions().get(0).getCallePrincipal())
+							.append(" ")
+							.append(cotizacion.getAsegurado().getDireccions().get(0).getNumero())
+							.append(" ")
+							.append(cotizacion.getAsegurado().getDireccions().get(0).getCalleSecundaria())
+							.append("</direccion>")
+							.append("<telefono>").append((cotizacion.getAsegurado().getTelefono()!=null && !cotizacion.getAsegurado().getTelefono().equals("")) ? cotizacion.getAsegurado().getTelefono():"-").append("</telefono>")
+						.append("</direccion></DireccionDTO>")
+					.append("</asegurado>");
 		if(endosoBeneficiario!=null){
 			Entidad entidadBeneficiario=entidadDAO.buscarEntidadPorIdEnsurance(endosoBeneficiario.getBeneficiario().getCodigoEnsurance().toString());
@@ -735,119 +726,3 @@
 		if(endosoBeneficiario!=null){
 			Entidad entidadBeneficiario=entidadDAO.buscarEntidadPorIdEnsurance(endosoBeneficiario.getBeneficiario().getCodigoEnsurance().toString());
-			    xml.append("<codigoEntidadFinanciera>").append(endosoBeneficiario.getBeneficiario().getCodigoEnsurance().toString()).append("</codigoEntidadFinanciera>");
-		}else{
-				xml.append("<codigoEntidadFinanciera>0</codigoEntidadFinanciera>");
-		}	
-		xml.append("<vigenciaDesde>").append(fechaInicioPoliza).append("</vigenciaDesde>")
-		.append("<valorAsegurado>").append(cotizacion.getSumaAseguradaTotal()).append("</valorAsegurado>")
-		.append("<vigenciaHasta>").append(fechaFinalPoliza).append("</vigenciaHasta>")
-		.append("<sucursalId>").append(cotizacion.getPuntoVenta().getSucursal().getSucEnsurance()).append("</sucursalId>")
-		.append("<esZonaAfectada>").append(zonaAfectada).append("</esZonaAfectada>")
-		.append("</detallesPoliza>")
-		.append("<loteCultivo>")
-		.append("<loteCultivoId>-1</loteCultivoId>")
-		.append("<nombre>").append(puntoVenta.getNombre()).append("</nombre>")
-		.append("<valorAsegurado>").append(cotizacion.getSumaAseguradaTotal()).append("</valorAsegurado>")
-		.append("<numeroHectareas>").append(objetoCotizacion.getHectareasLote()).append("</numeroHectareas>")
-		.append("<valorPorHectarea>").append(objetoCotizacion.getCostoProduccion()).append("</valorPorHectarea>")
-		.append("<gpsLoteX>").append(objetoCotizacion.getLatitud()).append("</gpsLoteX>")
-		.append("<gpsLoteY>").append(objetoCotizacion.getLongitud()).append("</gpsLoteY>")
-		.append("<tasa>").append(cotizacion.getTasaProductoValor()).append("</tasa>")
-		.append("<tipoCultivoId>").append(tipoCultivo.getCodEnsurance()).append("</tipoCultivoId>")
-		.append("<diasVigencia>").append(tipoCultivo.getVigenciaDias()).append("</diasVigencia>")
-		.append("<inicioVigenciaCultivo>").append(fechaInicioCultivo).append("</inicioVigenciaCultivo>")
-		.append("<finVigenciaCultivo>").append(fechaFinalCultivo).append("</finVigenciaCultivo>")
-		//.append("<inicioVigenciaCultivo>").append("06/11/2015").append("</inicioVigenciaCultivo>")
-		//.append("<finVigenciaCultivo>").append("06/02/2016").append("</finVigenciaCultivo>")
-		.append("<variedad>").append(objetoCotizacion.getVariedad()).append("</variedad>")
-		.append("<numeroHectareasAsegurables>").append(objetoCotizacion.getHectareasAsegurables()).append("</numeroHectareasAsegurables>")
-		.append("<esTecnificado>").append(agricultorTecnificado).append("</esTecnificado>")
-		//.append("<fechaTentativaSiembra>").append("06/11/2015").append("</fechaTentativaSiembra>")
-		.append("<fechaTentativaSiembra>").append(objetoCotizacion.getFechaSiembra()).append("</fechaTentativaSiembra>")
-		.append("<propiedadId>-1</propiedadId>")
-		.append("</loteCultivo>")
-
-		.append("<cliente>")
-		.append("<id>no</id>")
-				.append("<entidadId>")
-				.append(cliente.getEntidad().getEntEnsurance()==null||cliente.getEntidad().getEntEnsurance().trim().equals("0")?"no":cliente.getEntidad().getEntEnsurance()).append("</entidadId>")
-		.append("<nombres>").append(cliente.getEntidad().getNombres()).append("</nombres>")
-		.append("<apellidos>").append(cliente.getEntidad().getApellidos()==null?" ":cliente.getEntidad().getApellidos()).append("</apellidos>")
-		.append("<tipoIdentificacion>")
-		.append(cliente.getEntidad().getTipoIdentificacion().getId().equals("1") ? "c":cliente.getEntidad().getTipoIdentificacion().equals("2") ? "p":"r")
-		.append("</tipoIdentificacion>")
-		.append("<tipoEntidadId>").append(cliente.getEntidad().getTipoEntidad().getId()).append("</tipoEntidadId>")
-		.append("<identificacion>").append(cliente.getEntidad().getIdentificacion()).append("</identificacion>");
-		Entidad entidadBeneficiario=entidadDAO.buscarEntidadPorIdEnsurance(endosoBeneficiario.getBeneficiario().getCodigoEnsurance().toString());
-		if(!CorreoElectronico.trim().equalsIgnoreCase(""))
-			xml.append("<email>").append(CorreoElectronico).append("</email>");
-		else
-			xml.append("<email>").append(cliente.getEntidad().getMail()).append("</email>");
-		xml.append("<genero>f</genero>")
-		.append("<esEmpresa>")
-		.append(cliente.getEntidad().getTipoIdentificacion().getId().equals("1") ? "false":cliente.getEntidad().getTipoIdentificacion().getId().equals("2") ? "false":cliente.getEntidad().getTipoIdentificacion().getId().equals("3")?"false":"true")
-		.append("</esEmpresa>")
-		.append("<DireccionDTO><direccion>")
-		.append("<paisId>6815744</paisId>")
-		
-		.append("<provinciaId>").append(cliente.getEntidad().getDireccions().get(0).getCiudad().getProvincia().getCodigoSbs()).append("</provinciaId>")
-		.append("<ciudadId>").append(cliente.getEntidad().getDireccions().get(0).getCiudad().getId()).append("</ciudadId>");
-		if(cliente.getEntidad().getDireccions().get(0).getParroquia()!=null){
-			xml.append("<cantonId>").append(cliente.getEntidad().getDireccions().get(0).getParroquia().getCanton().getId()).append("</cantonId>")
-			.append("<parroquiaId>").append(cliente.getEntidad().getDireccions().get(0).getParroquia().getId()).append("</parroquiaId>");
-		}
-		else{
-			xml.append("<cantonId>").append("1201").append("</cantonId>")
-			.append("<parroquiaId>").append("120153").append("</parroquiaId>");
-		}
-		xml.append("<direccion>")
-		
-		.append(cliente.getEntidad().getDireccions().get(0).getCallePrincipal())
-		.append(" ")
-		.append(cliente.getEntidad().getDireccions().get(0).getNumero())
-		.append(" ")
-		.append(cliente.getEntidad().getDireccions().get(0).getCalleSecundaria())
-		.append("</direccion>")
-		.append("<telefono>").append((cliente.getEntidad().getTelefono()!=null && !cliente.getEntidad().getTelefono().equals("")) ? cliente.getEntidad().getTelefono():"-").append("</telefono>")
-		.append("</direccion></DireccionDTO>")
-		.append("</cliente>")
-		.append("<asegurado>")
-		.append("<id>no</id>")
-		.append("<entidadId>").append(cotizacion.getAsegurado().getEntEnsurance()).append("</entidadId>")
-		.append("<nombres>").append(cotizacion.getAsegurado().getNombres()).append("</nombres>")
-		.append("<apellidos>").append(cotizacion.getAsegurado().getApellidos()).append("</apellidos>")
-		.append("<tipoIdentificacion>")
-		.append(cotizacion.getAsegurado().getTipoIdentificacion().getId()=="1" ? "c":cliente.getEntidad().getTipoIdentificacion().getId()=="2" ? "p":"r")
-		.append("</tipoIdentificacion>")
-		.append("<tipoEntidadId>").append(cotizacion.getAsegurado().getTipoEntidad().getId()).append("</tipoEntidadId>")
-		.append("<identificacion>").append(cotizacion.getAsegurado().getIdentificacion()).append("</identificacion>")
-		.append("<genero>f</genero>")
-		.append("<esEmpresa>")
-		.append(cotizacion.getAsegurado().getTipoIdentificacion().getId()=="1" ? "false":cotizacion.getAsegurado().getTipoIdentificacion().getId()=="2" ? "false":cotizacion.getAsegurado().getTipoIdentificacion().getId()=="3"?"false":"true")
-		.append("</esEmpresa>")
-		.append("<DireccionDTO><direccion>")
-		.append("<paisId>6815744</paisId>")
-		.append("<provinciaId>").append(cotizacion.getAsegurado().getDireccions().get(0).getCiudad().getProvincia().getCodigoSbs()).append("</provinciaId>")
-		.append("<ciudadId>").append(cotizacion.getAsegurado().getDireccions().get(0).getCiudad().getId()).append("</ciudadId>");
-		if(cotizacion.getAsegurado().getDireccions().get(0).getParroquia()!=null){
-			xml.append("<cantonId>").append(cotizacion.getAsegurado().getDireccions().get(0).getParroquia().getCanton().getId()).append("</cantonId>")
-			.append("<parroquiaId>").append(cotizacion.getAsegurado().getDireccions().get(0).getParroquia().getId()).append("</parroquiaId>");
-		}
-		else{
-			xml.append("<cantonId>").append("1201").append("</cantonId>")
-			.append("<parroquiaId>").append("120153").append("</parroquiaId>");
-		}
-
-		xml.append("<direccion>")
-		.append(cotizacion.getAsegurado().getDireccions().get(0).getCallePrincipal())
-		.append(" ")
-		.append(cotizacion.getAsegurado().getDireccions().get(0).getNumero())
-		.append(" ")
-		.append(cotizacion.getAsegurado().getDireccions().get(0).getCalleSecundaria())
-		.append("</direccion>")
-		.append("<telefono>").append((cotizacion.getAsegurado().getTelefono()!=null && !cotizacion.getAsegurado().getTelefono().equals("")) ? cotizacion.getAsegurado().getTelefono():"-").append("</telefono>")
-		.append("</direccion></DireccionDTO>")
-		.append("</asegurado>");
-		if(endosoBeneficiario!=null){
-			entidadBeneficiario=entidadDAO.buscarEntidadPorIdEnsurance(endosoBeneficiario.getBeneficiario().getCodigoEnsurance().toString());
 			xml.append("<beneficiarios>")
@@ -853,28 +728,28 @@
 			xml.append("<beneficiarios>")
-			.append("<id>no</id>")
-			.append("<entidadId>").append(endosoBeneficiario.getBeneficiario().getCodigoEnsurance()).append("</entidadId>")
-			.append("<nombres>").append(endosoBeneficiario.getBeneficiario().getNombre()).append("</nombres>")
-			.append("<apellidos>").append(endosoBeneficiario.getBeneficiario().getNombre()).append("</apellidos>")
-			.append("<tipoIdentificacion>")
-			.append(entidadBeneficiario.getTipoIdentificacion().getId()=="1" ? "c":entidadBeneficiario.getTipoIdentificacion().getId()=="2" ? "p":"r")
-			.append("</tipoIdentificacion>")
-			.append("<tipoEntidadId>").append(entidadBeneficiario.getTipoEntidad().getId()).append("</tipoEntidadId>")
-			.append("<identificacion>").append(entidadBeneficiario.getIdentificacion()).append("</identificacion>")
-			.append("<esEmpresa>")
-			.append(entidadBeneficiario.getTipoIdentificacion().getId()=="1" ? "false":entidadBeneficiario.getTipoIdentificacion().getId()=="2" ? "false":entidadBeneficiario.getTipoIdentificacion().getId()=="3"?"false":"true")
-			.append("</esEmpresa>")
-			.append("<DireccionDTO>")
-			.append("<direccion>")
-			.append("<paisId>-1</paisId>")
-			.append("<provinciaId>-1</provinciaId>")
-			.append("<cantonId>-1</cantonId>")
-			.append("<parroquiaId>-1</parroquiaId>")
-			.append("<ciudadId>-1</ciudadId>")
-			.append("<direccion>-1</direccion>")
-			.append("<telefono>-1</telefono>")
-			.append("</direccion>")
-			.append("</DireccionDTO>")
+					.append("<id>no</id>")
+					.append("<entidadId>").append(endosoBeneficiario.getBeneficiario().getCodigoEnsurance()).append("</entidadId>")
+					.append("<nombres>").append(endosoBeneficiario.getBeneficiario().getNombre()).append("</nombres>")
+					.append("<apellidos>").append(endosoBeneficiario.getBeneficiario().getNombre()).append("</apellidos>")
+					.append("<tipoIdentificacion>")
+					.append(entidadBeneficiario.getTipoIdentificacion().getId()=="1" ? "c":entidadBeneficiario.getTipoIdentificacion().getId()=="2" ? "p":"r")
+					.append("</tipoIdentificacion>")
+					.append("<tipoEntidadId>").append(entidadBeneficiario.getTipoEntidad().getId()).append("</tipoEntidadId>")
+					.append("<identificacion>").append(entidadBeneficiario.getIdentificacion()).append("</identificacion>")
+					.append("<esEmpresa>")
+					.append(entidadBeneficiario.getTipoIdentificacion().getId()=="1" ? "false":entidadBeneficiario.getTipoIdentificacion().getId()=="2" ? "false":entidadBeneficiario.getTipoIdentificacion().getId()=="3"?"false":"true")
+					.append("</esEmpresa>")
+					.append("<DireccionDTO>")
+					.append("<direccion>")
+					.append("<paisId>-1</paisId>")
+					.append("<provinciaId>-1</provinciaId>")
+					.append("<cantonId>-1</cantonId>")
+					.append("<parroquiaId>-1</parroquiaId>")
+					.append("<ciudadId>-1</ciudadId>")
+					.append("<direccion>-1</direccion>")
+					.append("<telefono>-1</telefono>")
+					.append("</direccion>")
+					.append("</DireccionDTO>")
 			.append("</beneficiarios>");
 		}
 		else{
 			xml.append("<beneficiarios>")
@@ -877,27 +752,27 @@
 			.append("</beneficiarios>");
 		}
 		else{
 			xml.append("<beneficiarios>")
-			.append("<id>no</id>")
-			.append("<entidadId>-1</entidadId>")
-			.append("<nombres>-1</nombres>")
-			.append("<apellidos>-1</apellidos>")
-			.append("<tipoIdentificacion>-1</tipoIdentificacion>")
-			.append("<tipoEntidadId>-1</tipoEntidadId>")
-			.append("<identificacion>-1</identificacion>")
-			.append("<esEmpresa>-1</esEmpresa>")
-			.append("<DireccionDTO>")
-			.append("<direccion>")
-			.append("<paisId>-1</paisId>")
-			.append("<provinciaId>-1</provinciaId>")
-			.append("<cantonId>-1</cantonId>")
-			.append("<parroquiaId>-1</parroquiaId>")
-			.append("<ciudadId>-1</ciudadId>")
-			.append("<direccion>-1</direccion>")
-			.append("<telefono>-1</telefono>")
-			.append("</direccion>")
-			.append("</DireccionDTO>")
-			.append("</beneficiarios>");
+				.append("<id>no</id>")
+				.append("<entidadId>-1</entidadId>")
+				.append("<nombres>-1</nombres>")
+				.append("<apellidos>-1</apellidos>")
+				.append("<tipoIdentificacion>-1</tipoIdentificacion>")
+				.append("<tipoEntidadId>-1</tipoEntidadId>")
+				.append("<identificacion>-1</identificacion>")
+				.append("<esEmpresa>-1</esEmpresa>")
+				.append("<DireccionDTO>")
+				.append("<direccion>")
+				.append("<paisId>-1</paisId>")
+				.append("<provinciaId>-1</provinciaId>")
+				.append("<cantonId>-1</cantonId>")
+				.append("<parroquiaId>-1</parroquiaId>")
+				.append("<ciudadId>-1</ciudadId>")
+				.append("<direccion>-1</direccion>")
+				.append("<telefono>-1</telefono>")
+				.append("</direccion>")
+				.append("</DireccionDTO>")
+				.append("</beneficiarios>");
 		}
 		xml.append("</superObjetoXML>");
 		
diff --git a/src/com/qbe/cotizador/servlets/producto/agricola/AgriExportarDatos.java b/src/com/qbe/cotizador/servlets/producto/agricola/AgriExportarDatos.java
--- a/src/com/qbe/cotizador/servlets/producto/agricola/AgriExportarDatos.java
+++ b/src/com/qbe/cotizador/servlets/producto/agricola/AgriExportarDatos.java
@@ -92,7 +92,7 @@
 	 */
 	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
 		
-		//Cotizador 1.- Credife 2.- Cooprogreso
+		//Cotizador 1.- Credife 2.- Cooprogreso 3.- Agripac
 		String Cotizador = request.getParameter("cotizador") == null ? "" : request.getParameter("cotizador");
 		
 		//JSONObject retorno=new JSONObject();
@@ -119,27 +119,7 @@
 		TransporteData nuevaData=new TransporteData();
 
 
-		//Exportar los datos de los tipos de cultivo
-		/*AgriTipoCultivoDAO agriTipoCultivoDAO = new AgriTipoCultivoDAO();
-		List<AgriTipoCultivo> results = agriTipoCultivoDAO.BuscarTodos();
-		List<TipoCultivo> listadoTipoCultivo=new ArrayList<TipoCultivo>(); 
-		for (AgriTipoCultivo tipoCultivo: results)
-		{
-			TipoCultivo nuevoTipo=new TipoCultivo();
-			nuevoTipo.setTipoCultivoId(tipoCultivo.getTipoCultivoId());
-			nuevoTipo.setNombre(tipoCultivo.getNombre());
-			nuevoTipo.setTipo(tipoCultivo.getTipo());
-			nuevoTipo.setVigenciaDias(tipoCultivo.getVigenciaDias());
-			//TODO: se agrega el precio de ajuste y nombre de plantilla 
-			nuevoTipo.setPrecioAjuste(tipoCultivo.getPrecioAjuste());
-			nuevoTipo.setPrecioAjuste2(tipoCultivo.getPrecioAjuste2());
-			nuevoTipo.setUnidadMedida(tipoCultivo.getUnidadMedida());
-			nuevoTipo.setUnidadMedida2(tipoCultivo.getUnidadMedida2());
-			
-			//nuevoTipo.setNombrePlantilla(tipoCultivo.getNombrePlantilla());
-			listadoTipoCultivo.add(nuevoTipo);
-		}*/
-		
+				
 		AgriCultivoCanalDAO agriCultivoCanalDAO= new AgriCultivoCanalDAO();
 		List<TipoCultivo> listadoTipoCultivo=new ArrayList<TipoCultivo>();
 		switch (Cotizador) {
@@ -179,9 +159,27 @@
 				listadoTipoCultivo.add(nuevoTipo);
 			}
 			break;
+		case "3":
+			
+			List<AgriCultivoCanal> agriCultivoCanalAgripac= agriCultivoCanalDAO.buscarTipoCalculo(new BigInteger("31"));
+			for (AgriCultivoCanal tipoCultivo: agriCultivoCanalAgripac)
+			{
+				TipoCultivo nuevoTipo=new TipoCultivo();
+				nuevoTipo.setTipoCultivoId(tipoCultivo.getTipoCultivoId());
+				nuevoTipo.setNombre(tipoCultivo.getNombre());
+				nuevoTipo.setTipo(tipoCultivo.getTipo());
+				nuevoTipo.setVigenciaDias(tipoCultivo.getVigenciaDias());
+				//TODO: se agrega el precio de ajuste y nombre de plantilla 
+				nuevoTipo.setPrecioAjuste(tipoCultivo.getPrecioAjuste());
+				nuevoTipo.setPrecioAjuste2(tipoCultivo.getPrecioAjuste2());
+				nuevoTipo.setUnidadMedida(tipoCultivo.getUnidadMedida());
+				nuevoTipo.setUnidadMedida2(tipoCultivo.getUnidadMedida2());
+				listadoTipoCultivo.add(nuevoTipo);
+			}
+			break;
 		default:
 			break;
 		}
 		
 		//Exportar los datos de las reglas
 		AgriReglaDAO agriReglaDAO = new AgriReglaDAO();
@@ -182,10 +180,13 @@
 		default:
 			break;
 		}
 		
 		//Exportar los datos de las reglas
 		AgriReglaDAO agriReglaDAO = new AgriReglaDAO();
-		//List<AgriRegla> listadoAgriReglas = agriReglaDAO.BuscarTodos();
+		
+		PuntoVentaDAO puntoVentaRefDAO = new PuntoVentaDAO();
+		PuntoVenta puntoVentaRef= new PuntoVenta();
+		
 		String NombreCotizado="";
 		switch (Cotizador) {
 		case "1":
@@ -189,8 +190,8 @@
 		String NombreCotizado="";
 		switch (Cotizador) {
 		case "1":
-			NombreCotizado="CREDIFE";
+			NombreCotizado="CREDIFE";			
 			break;
 		case "2":
 			NombreCotizado="COOPROGRESO";
 			break;
@@ -193,8 +194,11 @@
 			break;
 		case "2":
 			NombreCotizado="COOPROGRESO";
 			break;
+		case "3":
+			NombreCotizado="AGRIPAC";
+			break;
 		default:
 			break;
 		}
 		
@@ -197,7 +201,9 @@
 		default:
 			break;
 		}
 		
+		puntoVentaRef=puntoVentaRefDAO.buscarPorNombre(NombreCotizado);
+		
 		List<AgriRegla> listadoAgriReglas = agriReglaDAO.BuscarPorTipoCalculoNombre(NombreCotizado);
 		///TODO: Se obtiene unicamante los que son para el offline 
 		//List<AgriRegla> listadoAgriReglas = agriReglaDAO.BuscarPorTipoCalculoNombre("GENERAL");
@@ -280,19 +286,6 @@
 			listaParametros.add(nuevoParametro);
 		}
 
-		//Exportar datos de las parroquias
-		//enviamos los que estan en la tabla agriparroquias ya que es la mas completa que se tiene, hasta que se iguale correctamente la tabla principal de cantones
-		/*ParroquiaDAO parroquiaDAO=new ParroquiaDAO();
-		List<Parroquia> listadoParroquias = parroquiaDAO.buscarTodos();
-		List<com.qbe.cotizador.servlets.producto.agricola.Parroquia> listaParroquias=new ArrayList<com.qbe.cotizador.servlets.producto.agricola.Parroquia>();
-		for(Parroquia parroquiaActual:listadoParroquias){
-			com.qbe.cotizador.servlets.producto.agricola.Parroquia nuevoParroquia=new com.qbe.cotizador.servlets.producto.agricola.Parroquia();
-			nuevoParroquia.setCantonId(parroquiaActual.getCanton().getId());
-			nuevoParroquia.setParroquiaId(parroquiaActual.getId());
-			nuevoParroquia.setNombre(parroquiaActual.getNombre());
-			listaParroquias.add(nuevoParroquia);
-		}*/
-
 		AgriParroquiaDAO parroquiaDAO=new AgriParroquiaDAO();
 		List<AgriParroquia> listadoParroquias = parroquiaDAO.buscarTodos();
 		List<com.qbe.cotizador.servlets.producto.agricola.Parroquia> listaParroquias=new ArrayList<com.qbe.cotizador.servlets.producto.agricola.Parroquia>();
@@ -370,5 +363,6 @@
 		nuevoParametroGeneral.setDiasValidacionCultivo(Integer.parseInt(DiasValidacionCultivo));
 		nuevoParametroGeneral.setMailFactuacionElectronica(MailFacturacionElectronica);
 		
-		//Exportar los datos de los paramatros por canal para el nombre de la plantilla
+		//Exportar los datos de los parametros por canal para el nombre de la plantilla
+		
 		AgriParametroXCanalDAO agriParametroXCanalDAO = new AgriParametroXCanalDAO();
@@ -374,5 +368,5 @@
 		AgriParametroXCanalDAO agriParametroXCanalDAO = new AgriParametroXCanalDAO();
-		List<AgriParametroXCanal> resultsPxC = agriParametroXCanalDAO.BuscarTodos();
+		List<AgriParametroXCanal> resultsPxC = agriParametroXCanalDAO.ObtenerPorPuntoVenta(new BigInteger(puntoVentaRef.getId()));
 		List<ParametrosXCanal> listadoParametrosXCanal=new ArrayList<ParametrosXCanal>(); 
 		for (AgriParametroXCanal parametroXCanal: resultsPxC)
 			{
@@ -385,28 +379,7 @@
 				listadoParametrosXCanal.add(nuevoParametroCanal);
 			}
 		
-		//TODO: Cargar plantillas
-		/*List<com.qbe.cotizador.servlets.producto.agricola.PlantillasReporte> listaPlantillaReporte=new ArrayList<com.qbe.cotizador.servlets.producto.agricola.PlantillasReporte>();
-		for (ParametrosXCanal parametroPorCanal :listadoParametrosXCanal){
-			com.qbe.cotizador.servlets.producto.agricola.PlantillasReporte plantillaRep = new com.qbe.cotizador.servlets.producto.agricola.PlantillasReporte();
-			String html="";
-			String PlantillaName="";
-			PlantillaName=parametroPorCanal.getNombrePlantilla();
-			if (PlantillaName==null)
-				PlantillaName="TipoCultivoMaiz";
-			try{
-				String rutaPlantilla = this.getServletContext().getRealPath("") + "/static/plantillas/"+PlantillaName+".html";
-				html = Files.toString(new File(rutaPlantilla), Charsets.UTF_8);
-			}
-			catch(IOException ex){
-			}
-			plantillaRep.setNombrePlantilla(PlantillaName);
-			plantillaRep.setPlantilla(html);
-			listaPlantillaReporte.add(plantillaRep);
-		}*/
-		
-		//nuevoParametroGeneral.setTextoPlantilla(html);
-		
+				
 		nuevaData.setParametrosGenerales(nuevoParametroGeneral);
 		nuevaData.setCantones(listaCantones);
 		nuevaData.setCiclos(listaCiclos);
diff --git a/src/com/qbe/cotizador/servlets/producto/agricola/AgriParametroXCanalController.java b/src/com/qbe/cotizador/servlets/producto/agricola/AgriParametroXCanalController.java
--- a/src/com/qbe/cotizador/servlets/producto/agricola/AgriParametroXCanalController.java
+++ b/src/com/qbe/cotizador/servlets/producto/agricola/AgriParametroXCanalController.java
@@ -105,7 +105,7 @@
 				parametroXCanal.setPlantillaNombre(plantillaNombre);
 			if(!FileName.equals("")){
 				
-				String rutaPlantilla = this.getServletContext().getRealPath("")+ "/static/plantillas/Agricola/PlantillasCultivos/" + FileName;
+				String rutaPlantilla = this.getServletContext().getRealPath("")+File.separator +"static"+File.separator +"plantillas"+File.separator +"Agricola"+File.separator +"PlantillasCultivos"+File.separator + FileName;
 				System.out.println("Entra el html "+rutaPlantilla); 
 				File f1=new File(rutaPlantilla);
 				 FileInputStream f_in=new FileInputStream(f1);
@@ -135,7 +135,7 @@
 							String rutaPlantilla = AgriSucreNotificacionErrores.class.getProtectionDomain().getCodeSource()
 									.getLocation().getPath();
 							rutaPlantilla=rutaPlantilla.replace("AgriSucreNotificacionErrores.class", "");
-							String rutaRelativaReporte="../../../../../../../../static/plantillas/Agricola/PlantillasCultivos/";
+							String rutaRelativaReporte=".."+File.separator +".."+File.separator +".."+File.separator +".."+File.separator +".."+File.separator +".."+File.separator +".."+File.separator +".."+File.separator +"static"+File.separator +"plantillas"+File.separator +"Agricola"+File.separator +"PlantillasCultivos"+File.separator;
 							rutaPlantilla=rutaPlantilla+rutaRelativaReporte;
 							System.out.println("Ruta!:"+rutaPlantilla);
 							String fileName = item.getName();
